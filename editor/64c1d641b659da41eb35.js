webpackJsonp([0],{1347:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,a=i(553),n=(r=a)&&r.__esModule?r:{default:r};var s=function t(e,i){this.arr_=void 0!==e?e:[],this.usage_=void 0!==i?i:t.Usage_.STATIC_DRAW};s.prototype.getArray=function(){return this.arr_},s.prototype.getUsage=function(){return this.usage_},s.Usage_={STATIC_DRAW:n.default.STATIC_DRAW,STREAM_DRAW:n.default.STREAM_DRAW,DYNAMIC_DRAW:n.default.DYNAMIC_DRAW},e.default=s},1348:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(i(1)),a=s(i(553)),n=s(i(1356));function s(t){return t&&t.__esModule?t:{default:t}}var o=function(t){n.default.call(this,t)};r.default.inherits(o,n.default),o.prototype.getType=function(){return a.default.FRAGMENT_SHADER},e.default=o},1349:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(i(1)),a=s(i(553)),n=s(i(1356));function s(t){return t&&t.__esModule?t:{default:t}}var o=function(t){n.default.call(this,t)};r.default.inherits(o,n.default),o.prototype.getType=function(){return a.default.VERTEX_SHADER},e.default=o},1350:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=u(i(1)),a=u(i(11)),n=u(i(328)),s=u(i(47)),o=u(i(1357)),l=u(i(553));function u(t){return t&&t.__esModule?t:{default:t}}var f=function(t,e){n.default.call(this),this.tolerance=t,this.maxExtent=e,this.origin=a.default.getCenter(e),this.projectionMatrix_=s.default.create(),this.offsetRotateMatrix_=s.default.create(),this.offsetScaleMatrix_=s.default.create(),this.tmpMat4_=o.default.create(),this.indices=[],this.indicesBuffer=null,this.startIndices=[],this.startIndicesFeature=[],this.vertices=[],this.verticesBuffer=null,this.lineStringReplay=void 0};r.default.inherits(f,n.default),f.prototype.getDeleteResourcesFunction=function(t){},f.prototype.finish=function(t){},f.prototype.setUpProgram=function(t,e,i,r){},f.prototype.shutDownProgram=function(t,e){},f.prototype.drawReplay=function(t,e,i,r){},f.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,a){},f.prototype.drawHitDetectionReplay=function(t,e,i,r,a,n){return a?this.drawHitDetectionReplayOneByOne(t,e,i,r,n):this.drawHitDetectionReplayAll(t,e,i,r)},f.prototype.drawHitDetectionReplayAll=function(t,e,i,r){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawReplay(t,e,i,!0);var a=r(null);return a||void 0},f.prototype.replay=function(t,e,i,r,a,n,u,f,d,h,c){var _,p,g,v,y,x,m,E,C=t.getGL();this.lineStringReplay&&(_=C.isEnabled(C.STENCIL_TEST),p=C.getParameter(C.STENCIL_FUNC),g=C.getParameter(C.STENCIL_VALUE_MASK),v=C.getParameter(C.STENCIL_REF),y=C.getParameter(C.STENCIL_WRITEMASK),x=C.getParameter(C.STENCIL_FAIL),m=C.getParameter(C.STENCIL_PASS_DEPTH_PASS),E=C.getParameter(C.STENCIL_PASS_DEPTH_FAIL),C.enable(C.STENCIL_TEST),C.clear(C.STENCIL_BUFFER_BIT),C.stencilMask(255),C.stencilFunc(C.ALWAYS,1,255),C.stencilOp(C.KEEP,C.KEEP,C.REPLACE),this.lineStringReplay.replay(t,e,i,r,a,n,u,f,d,h,c),C.stencilMask(0),C.stencilFunc(C.NOTEQUAL,1,255)),t.bindBuffer(l.default.ARRAY_BUFFER,this.verticesBuffer),t.bindBuffer(l.default.ELEMENT_ARRAY_BUFFER,this.indicesBuffer);var T=this.setUpProgram(C,t,a,n),I=s.default.reset(this.projectionMatrix_);s.default.scale(I,2/(i*a[0]),2/(i*a[1])),s.default.rotate(I,-r),s.default.translate(I,-(e[0]-this.origin[0]),-(e[1]-this.origin[1]));var L=s.default.reset(this.offsetScaleMatrix_);s.default.scale(L,2/a[0],2/a[1]);var R,S=s.default.reset(this.offsetRotateMatrix_);return 0!==r&&s.default.rotate(S,-r),C.uniformMatrix4fv(T.u_projectionMatrix,!1,o.default.fromTransform(this.tmpMat4_,I)),C.uniformMatrix4fv(T.u_offsetScaleMatrix,!1,o.default.fromTransform(this.tmpMat4_,L)),C.uniformMatrix4fv(T.u_offsetRotateMatrix,!1,o.default.fromTransform(this.tmpMat4_,S)),C.uniform1f(T.u_opacity,u),void 0===d?this.drawReplay(C,t,f,!1):R=this.drawHitDetectionReplay(C,t,f,d,h,c),this.shutDownProgram(C,T),this.lineStringReplay&&(_||C.disable(C.STENCIL_TEST),C.clear(C.STENCIL_BUFFER_BIT),C.stencilFunc(p,v,g),C.stencilMask(y),C.stencilOp(x,E,m)),R},f.prototype.drawElements=function(t,e,i,r){var a=e.hasOESElementIndexUint?l.default.UNSIGNED_INT:l.default.UNSIGNED_SHORT,n=r-i,s=i*(e.hasOESElementIndexUint?4:2);t.drawElements(l.default.TRIANGLES,n,a,s)},e.default=f},1351:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,a=i(1365),n=(r=a)&&r.__esModule?r:{default:r};var s={defaultFont:"10px sans-serif",defaultFillStyle:[0,0,0,1],defaultLineCap:"round",defaultLineDash:[],defaultLineDashOffset:0,defaultLineJoin:"round",defaultMiterLimit:10,defaultStrokeStyle:[0,0,0,1],defaultTextAlign:.5,defaultTextBaseline:.5,defaultLineWidth:1,triangleIsCounterClockwise:function(t,e,i,r,a,n){var o=(i-t)*(n-e)-(a-t)*(r-e);return o<=s.EPSILON&&o>=-s.EPSILON?void 0:o>0}};s.EPSILON=n.default||2.220446049250313e-16,e.default=s},1352:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=f(i(1)),a=f(i(231)),n=f(i(28)),s=f(i(19)),o=f(i(18)),l=f(i(553)),u=f(i(1359));function f(t){return t&&t.__esModule?t:{default:t}}var d=function(t,e){this.canvas_=t,this.gl_=e,this.bufferCache_={},this.shaderCache_={},this.programCache_={},this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null,this.hasOESElementIndexUint=n.default.includes(r.default.WEBGL_EXTENSIONS,"OES_element_index_uint"),this.hasOESElementIndexUint&&e.getExtension("OES_element_index_uint"),s.default.listen(this.canvas_,u.default.LOST,this.handleWebGLContextLost,this),s.default.listen(this.canvas_,u.default.RESTORED,this.handleWebGLContextRestored,this)};r.default.inherits(d,a.default),d.prototype.bindBuffer=function(t,e){var i=this.getGL(),a=e.getArray(),n=String(r.default.getUid(e));if(n in this.bufferCache_){var s=this.bufferCache_[n];i.bindBuffer(t,s.buffer)}else{var o,u=i.createBuffer();i.bindBuffer(t,u),t==l.default.ARRAY_BUFFER?o=new Float32Array(a):t==l.default.ELEMENT_ARRAY_BUFFER&&(o=this.hasOESElementIndexUint?new Uint32Array(a):new Uint16Array(a)),i.bufferData(t,o,e.getUsage()),this.bufferCache_[n]={buf:e,buffer:u}}},d.prototype.deleteBuffer=function(t){var e=this.getGL(),i=String(r.default.getUid(t)),a=this.bufferCache_[i];e.isContextLost()||e.deleteBuffer(a.buffer),delete this.bufferCache_[i]},d.prototype.disposeInternal=function(){s.default.unlistenAll(this.canvas_);var t=this.getGL();if(!t.isContextLost()){var e;for(e in this.bufferCache_)t.deleteBuffer(this.bufferCache_[e].buffer);for(e in this.programCache_)t.deleteProgram(this.programCache_[e]);for(e in this.shaderCache_)t.deleteShader(this.shaderCache_[e]);t.deleteFramebuffer(this.hitDetectionFramebuffer_),t.deleteRenderbuffer(this.hitDetectionRenderbuffer_),t.deleteTexture(this.hitDetectionTexture_)}},d.prototype.getCanvas=function(){return this.canvas_},d.prototype.getGL=function(){return this.gl_},d.prototype.getHitDetectionFramebuffer=function(){return this.hitDetectionFramebuffer_||this.initHitDetectionFramebuffer_(),this.hitDetectionFramebuffer_},d.prototype.getShader=function(t){var e=String(r.default.getUid(t));if(e in this.shaderCache_)return this.shaderCache_[e];var i=this.getGL(),a=i.createShader(t.getType());return i.shaderSource(a,t.getSource()),i.compileShader(a),this.shaderCache_[e]=a,a},d.prototype.getProgram=function(t,e){var i=r.default.getUid(t)+"/"+r.default.getUid(e);if(i in this.programCache_)return this.programCache_[i];var a=this.getGL(),n=a.createProgram();return a.attachShader(n,this.getShader(t)),a.attachShader(n,this.getShader(e)),a.linkProgram(n),this.programCache_[i]=n,n},d.prototype.handleWebGLContextLost=function(){o.default.clear(this.bufferCache_),o.default.clear(this.shaderCache_),o.default.clear(this.programCache_),this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null},d.prototype.handleWebGLContextRestored=function(){},d.prototype.initHitDetectionFramebuffer_=function(){var t=this.gl_,e=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,e);var i=d.createEmptyTexture(t,1,1),r=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,r),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,1,1),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,r),t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),this.hitDetectionFramebuffer_=e,this.hitDetectionTexture_=i,this.hitDetectionRenderbuffer_=r},d.prototype.useProgram=function(t){return t!=this.currentProgram_&&(this.getGL().useProgram(t),this.currentProgram_=t,!0)},d.createTexture_=function(t,e,i){var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),void 0!==e&&t.texParameteri(l.default.TEXTURE_2D,l.default.TEXTURE_WRAP_S,e),void 0!==i&&t.texParameteri(l.default.TEXTURE_2D,l.default.TEXTURE_WRAP_T,i),r},d.createEmptyTexture=function(t,e,i,r,a){var n=d.createTexture_(t,r,a);return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,i,0,t.RGBA,t.UNSIGNED_BYTE,null),n},d.createTexture=function(t,e,i,r){var a=d.createTexture_(t,i,r);return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),a},e.default=d},1353:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=p(i(1)),a=p(i(327)),n=p(i(176)),s=p(i(1354)),o=p(i(558)),l=p(i(1381)),u=p(i(1382)),f=p(i(47)),d=p(i(1357)),h=p(i(553)),c=p(i(1347)),_=p(i(1352));function p(t){return t&&t.__esModule?t:{default:t}}var g=function(t,e){o.default.call(this,e),this.mapRenderer=t,this.arrayBuffer_=new c.default([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]),this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0,this.texCoordMatrix=f.default.create(),this.projectionMatrix=f.default.create(),this.tmpMat4_=d.default.create(),this.defaultLocations_=null};r.default.inherits(g,o.default),g.prototype.bindFramebuffer=function(t,e){var i=this.mapRenderer.getGL();if(void 0===this.framebufferDimension||this.framebufferDimension!=e){var r=function(t,e,i){t.isContextLost()||(t.deleteFramebuffer(e),t.deleteTexture(i))}.bind(null,i,this.framebuffer,this.texture);t.postRenderFunctions.push(r);var a=_.default.createEmptyTexture(i,e,e),n=i.createFramebuffer();i.bindFramebuffer(h.default.FRAMEBUFFER,n),i.framebufferTexture2D(h.default.FRAMEBUFFER,h.default.COLOR_ATTACHMENT0,h.default.TEXTURE_2D,a,0),this.texture=a,this.framebuffer=n,this.framebufferDimension=e}else i.bindFramebuffer(h.default.FRAMEBUFFER,this.framebuffer)},g.prototype.composeFrame=function(t,e,i){this.dispatchComposeEvent_(n.default.PRECOMPOSE,i,t),i.bindBuffer(h.default.ARRAY_BUFFER,this.arrayBuffer_);var r,a=i.getGL(),s=l.default.fragment,o=l.default.vertex,f=i.getProgram(s,o);this.defaultLocations_?r=this.defaultLocations_:(r=new u.default(a,f),this.defaultLocations_=r),i.useProgram(f)&&(a.enableVertexAttribArray(r.a_position),a.vertexAttribPointer(r.a_position,2,h.default.FLOAT,!1,16,0),a.enableVertexAttribArray(r.a_texCoord),a.vertexAttribPointer(r.a_texCoord,2,h.default.FLOAT,!1,16,8),a.uniform1i(r.u_texture,0)),a.uniformMatrix4fv(r.u_texCoordMatrix,!1,d.default.fromTransform(this.tmpMat4_,this.getTexCoordMatrix())),a.uniformMatrix4fv(r.u_projectionMatrix,!1,d.default.fromTransform(this.tmpMat4_,this.getProjectionMatrix())),a.uniform1f(r.u_opacity,e.opacity),a.bindTexture(h.default.TEXTURE_2D,this.getTexture()),a.drawArrays(h.default.TRIANGLE_STRIP,0,4),this.dispatchComposeEvent_(n.default.POSTCOMPOSE,i,t)},g.prototype.dispatchComposeEvent_=function(t,e,i){var r=this.getLayer();if(r.hasListener(t)){var n=i.viewState,o=n.resolution,l=i.pixelRatio,u=i.extent,f=n.center,d=n.rotation,h=i.size,c=new s.default(e,f,o,d,h,u,l),_=new a.default(t,c,i,null,e);r.dispatchEvent(_)}},g.prototype.getTexCoordMatrix=function(){return this.texCoordMatrix},g.prototype.getTexture=function(){return this.texture},g.prototype.getProjectionMatrix=function(){return this.projectionMatrix},g.prototype.handleWebGLContextLost=function(){this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0},g.prototype.prepareFrame=function(t,e,i){},g.prototype.forEachLayerAtPixel=function(t,e,i,r){},e.default=g},1354:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=u(i(1)),a=u(i(11)),n=u(i(33)),s=u(i(181)),o=u(i(328)),l=u(i(1355));function u(t){return t&&t.__esModule?t:{default:t}}var f=function(t,e,i,r,a,n,s){o.default.call(this),this.context_=t,this.center_=e,this.extent_=n,this.pixelRatio_=s,this.size_=a,this.rotation_=r,this.resolution_=i,this.imageStyle_=null,this.fillStyle_=null,this.strokeStyle_=null,this.textStyle_=null};r.default.inherits(f,o.default),f.prototype.drawText_=function(t,e){var i=this.context_,r=t.getReplay(0,s.default.TEXT);r.setTextStyle(this.textStyle_),r.drawText(e,null),r.finish(i);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)()},f.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},f.prototype.drawGeometry=function(t){switch(t.getType()){case n.default.POINT:this.drawPoint(t,null);break;case n.default.LINE_STRING:this.drawLineString(t,null);break;case n.default.POLYGON:this.drawPolygon(t,null);break;case n.default.MULTI_POINT:this.drawMultiPoint(t,null);break;case n.default.MULTI_LINE_STRING:this.drawMultiLineString(t,null);break;case n.default.MULTI_POLYGON:this.drawMultiPolygon(t,null);break;case n.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(t,null);break;case n.default.CIRCLE:this.drawCircle(t,null)}},f.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&a.default.intersects(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},f.prototype.drawGeometryCollection=function(t,e){var i,r,a=t.getGeometriesArray();for(i=0,r=a.length;i<r;++i)this.drawGeometry(a[i])},f.prototype.drawPoint=function(t,e){var i=this.context_,r=new l.default(1,this.extent_),a=r.getReplay(0,s.default.IMAGE);a.setImageStyle(this.imageStyle_),a.drawPoint(t,e),a.finish(i);a.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),a.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},f.prototype.drawMultiPoint=function(t,e){var i=this.context_,r=new l.default(1,this.extent_),a=r.getReplay(0,s.default.IMAGE);a.setImageStyle(this.imageStyle_),a.drawMultiPoint(t,e),a.finish(i);a.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),a.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},f.prototype.drawLineString=function(t,e){var i=this.context_,r=new l.default(1,this.extent_),a=r.getReplay(0,s.default.LINE_STRING);a.setFillStrokeStyle(null,this.strokeStyle_),a.drawLineString(t,e),a.finish(i);a.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),a.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},f.prototype.drawMultiLineString=function(t,e){var i=this.context_,r=new l.default(1,this.extent_),a=r.getReplay(0,s.default.LINE_STRING);a.setFillStrokeStyle(null,this.strokeStyle_),a.drawMultiLineString(t,e),a.finish(i);a.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),a.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},f.prototype.drawPolygon=function(t,e){var i=this.context_,r=new l.default(1,this.extent_),a=r.getReplay(0,s.default.POLYGON);a.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),a.drawPolygon(t,e),a.finish(i);a.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),a.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},f.prototype.drawMultiPolygon=function(t,e){var i=this.context_,r=new l.default(1,this.extent_),a=r.getReplay(0,s.default.POLYGON);a.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),a.drawMultiPolygon(t,e),a.finish(i);a.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),a.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},f.prototype.drawCircle=function(t,e){var i=this.context_,r=new l.default(1,this.extent_),a=r.getReplay(0,s.default.CIRCLE);a.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),a.drawCircle(t,e),a.finish(i);a.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),a.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},f.prototype.setImageStyle=function(t){this.imageStyle_=t},f.prototype.setFillStrokeStyle=function(t,e){this.fillStyle_=t,this.strokeStyle_=e},f.prototype.setTextStyle=function(t){this.textStyle_=t},e.default=f},1355:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=p(i(13)),a=p(i(1)),n=p(i(28)),s=p(i(11)),o=p(i(18)),l=p(i(177)),u=p(i(562)),f=p(i(1362)),d=p(i(1368)),h=p(i(1360)),c=p(i(1374)),_=p(i(1378));function p(t){return t&&t.__esModule?t:{default:t}}var g=function(t,e,i){u.default.call(this),this.maxExtent_=e,this.tolerance_=t,this.renderBuffer_=i,this.replaysByZIndex_={}};a.default.inherits(g,u.default),g.prototype.addDeclutter=function(t,e){},g.prototype.getDeleteResourcesFunction=function(t){var e,i=[];for(e in this.replaysByZIndex_){var r,a=this.replaysByZIndex_[e];for(r in a)i.push(a[r].getDeleteResourcesFunction(t))}return function(){for(var t,e=i.length,r=0;r<e;r++)t=i[r].apply(this,arguments);return t}},g.prototype.finish=function(t){var e;for(e in this.replaysByZIndex_){var i,r=this.replaysByZIndex_[e];for(i in r)r[i].finish(t)}},g.prototype.getReplay=function(t,e){var i=void 0!==t?t.toString():"0",r=this.replaysByZIndex_[i];void 0===r&&(r={},this.replaysByZIndex_[i]=r);var a=r[e];void 0===a&&(a=new(0,g.BATCH_CONSTRUCTORS_[e])(this.tolerance_,this.maxExtent_),r[e]=a);return a},g.prototype.isEmpty=function(){return o.default.isEmpty(this.replaysByZIndex_)},g.prototype.replay=function(t,e,i,a,s,o,u,f){var d,h,c,_,p,g,v=(0,r.default)(this.replaysByZIndex_).map(Number);for(v.sort(n.default.numberSafeCompareFunction),d=0,h=v.length;d<h;++d)for(p=this.replaysByZIndex_[v[d].toString()],c=0,_=l.default.ORDER.length;c<_;++c)void 0!==(g=p[l.default.ORDER[c]])&&g.replay(t,e,i,a,s,o,u,f,void 0,!1)},g.prototype.replayHitDetection_=function(t,e,i,a,n,s,o,u,f,d,h){var c,_,p,g,v,y,x=(0,r.default)(this.replaysByZIndex_).map(Number);for(x.sort(function(t,e){return e-t}),c=0,_=x.length;c<_;++c)for(g=this.replaysByZIndex_[x[c].toString()],p=l.default.ORDER.length-1;p>=0;--p)if(void 0!==(v=g[l.default.ORDER[p]])&&(y=v.replay(t,e,i,a,n,s,o,u,f,d,h)))return y},g.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,a,n,o,l,u,f){var d,h=e.getGL();return h.bindFramebuffer(h.FRAMEBUFFER,e.getHitDetectionFramebuffer()),void 0!==this.renderBuffer_&&(d=s.default.buffer(s.default.createOrUpdateFromCoordinate(t),r*this.renderBuffer_)),this.replayHitDetection_(e,t,r,a,g.HIT_DETECTION_SIZE_,o,l,u,function(t){var e=new Uint8Array(4);if(h.readPixels(0,0,1,1,h.RGBA,h.UNSIGNED_BYTE,e),e[3]>0){var i=f(t);if(i)return i}},!0,d)},g.prototype.hasFeatureAtCoordinate=function(t,e,i,r,a,n,s,o,l){var u=e.getGL();return u.bindFramebuffer(u.FRAMEBUFFER,e.getHitDetectionFramebuffer()),void 0!==this.replayHitDetection_(e,t,r,a,g.HIT_DETECTION_SIZE_,s,o,l,function(t){var e=new Uint8Array(4);return u.readPixels(0,0,1,1,u.RGBA,u.UNSIGNED_BYTE,e),e[3]>0},!1)},g.HIT_DETECTION_SIZE_=[1,1],g.BATCH_CONSTRUCTORS_={Circle:f.default,Image:d.default,LineString:h.default,Polygon:c.default,Text:_.default},e.default=g},1356:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,a=i(51),n=(r=a)&&r.__esModule?r:{default:r};var s=function(t){this.source_=t};s.prototype.getType=function(){},s.prototype.getSource=function(){return this.source_},s.prototype.isAnimated=n.default.FALSE,e.default=s},1357:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={create:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},fromTransform:function(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}};e.default=r},1358:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=d(i(1)),a=d(i(11)),n=d(i(18)),s=d(i(1369)),o=d(i(1370)),l=d(i(1350)),u=d(i(553)),f=d(i(1352));function d(t){return t&&t.__esModule?t:{default:t}}var h=function(t,e){l.default.call(this,t,e),this.anchorX=void 0,this.anchorY=void 0,this.groupIndices=[],this.hitDetectionGroupIndices=[],this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.defaultLocations=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.width=void 0};r.default.inherits(h,l.default),h.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer,r=this.getTextures(!0),a=t.getGL();return function(){var n,s;if(!a.isContextLost())for(n=0,s=r.length;n<s;++n)a.deleteTexture(r[n]);t.deleteBuffer(e),t.deleteBuffer(i)}},h.prototype.drawCoordinates=function(t,e,i,r){var a,n,s,o,l,u,f=this.anchorX,d=this.anchorY,h=this.height,c=this.imageHeight,_=this.imageWidth,p=this.opacity,g=this.originX,v=this.originY,y=this.rotateWithView?1:0,x=-this.rotation,m=this.scale,E=this.width,C=Math.cos(x),T=Math.sin(x),I=this.indices.length,L=this.vertices.length;for(a=e;a<i;a+=r)l=t[a]-this.origin[0],u=t[a+1]-this.origin[1],n=L/8,s=-m*f,o=-m*(h-d),this.vertices[L++]=l,this.vertices[L++]=u,this.vertices[L++]=s*C-o*T,this.vertices[L++]=s*T+o*C,this.vertices[L++]=g/_,this.vertices[L++]=(v+h)/c,this.vertices[L++]=p,this.vertices[L++]=y,s=m*(E-f),o=-m*(h-d),this.vertices[L++]=l,this.vertices[L++]=u,this.vertices[L++]=s*C-o*T,this.vertices[L++]=s*T+o*C,this.vertices[L++]=(g+E)/_,this.vertices[L++]=(v+h)/c,this.vertices[L++]=p,this.vertices[L++]=y,s=m*(E-f),o=m*d,this.vertices[L++]=l,this.vertices[L++]=u,this.vertices[L++]=s*C-o*T,this.vertices[L++]=s*T+o*C,this.vertices[L++]=(g+E)/_,this.vertices[L++]=v/c,this.vertices[L++]=p,this.vertices[L++]=y,s=-m*f,o=m*d,this.vertices[L++]=l,this.vertices[L++]=u,this.vertices[L++]=s*C-o*T,this.vertices[L++]=s*T+o*C,this.vertices[L++]=g/_,this.vertices[L++]=v/c,this.vertices[L++]=p,this.vertices[L++]=y,this.indices[I++]=n,this.indices[I++]=n+1,this.indices[I++]=n+2,this.indices[I++]=n,this.indices[I++]=n+2,this.indices[I++]=n+3;return L},h.prototype.createTextures=function(t,e,i,a){var n,s,o,l,d=e.length;for(l=0;l<d;++l)s=e[l],(o=r.default.getUid(s).toString())in i?n=i[o]:(n=f.default.createTexture(a,s,u.default.CLAMP_TO_EDGE,u.default.CLAMP_TO_EDGE),i[o]=n),t[l]=n},h.prototype.setUpProgram=function(t,e,i,r){var a,n=s.default.fragment,l=s.default.vertex,f=e.getProgram(n,l);return this.defaultLocations?a=this.defaultLocations:(a=new o.default(t,f),this.defaultLocations=a),e.useProgram(f),t.enableVertexAttribArray(a.a_position),t.vertexAttribPointer(a.a_position,2,u.default.FLOAT,!1,32,0),t.enableVertexAttribArray(a.a_offsets),t.vertexAttribPointer(a.a_offsets,2,u.default.FLOAT,!1,32,8),t.enableVertexAttribArray(a.a_texCoord),t.vertexAttribPointer(a.a_texCoord,2,u.default.FLOAT,!1,32,16),t.enableVertexAttribArray(a.a_opacity),t.vertexAttribPointer(a.a_opacity,1,u.default.FLOAT,!1,32,24),t.enableVertexAttribArray(a.a_rotateWithView),t.vertexAttribPointer(a.a_rotateWithView,1,u.default.FLOAT,!1,32,28),a},h.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_offsets),t.disableVertexAttribArray(e.a_texCoord),t.disableVertexAttribArray(e.a_opacity),t.disableVertexAttribArray(e.a_rotateWithView)},h.prototype.drawReplay=function(t,e,i,r){var a,s,o,l=r?this.getHitDetectionTextures():this.getTextures(),f=r?this.hitDetectionGroupIndices:this.groupIndices;if(n.default.isEmpty(i))for(a=0,s=l.length,o=0;a<s;++a){t.bindTexture(u.default.TEXTURE_2D,l[a]);var d=f[a];this.drawElements(t,e,o,d),o=d}else this.drawReplaySkipping(t,e,i,l,f)},h.prototype.drawReplaySkipping=function(t,e,i,a,n){var s,o,l=0;for(s=0,o=a.length;s<o;++s){t.bindTexture(u.default.TEXTURE_2D,a[s]);for(var f=s>0?n[s-1]:0,d=n[s],h=f,c=f;l<this.startIndices.length&&this.startIndices[l]<=d;){var _=this.startIndicesFeature[l];void 0!==i[r.default.getUid(_).toString()]?(h!==c&&this.drawElements(t,e,h,c),c=h=l===this.startIndices.length-1?d:this.startIndices[l+1]):c=l===this.startIndices.length-1?d:this.startIndices[l+1],l++}h!==c&&this.drawElements(t,e,h,c)}},h.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,n,s){var o,l,f,d,h,c=this.startIndices.length-1,_=this.getHitDetectionTextures();for(o=_.length-1;o>=0;--o)for(t.bindTexture(u.default.TEXTURE_2D,_[o]),l=o>0?this.hitDetectionGroupIndices[o-1]:0,d=this.hitDetectionGroupIndices[o];c>=0&&this.startIndices[c]>=l;){if(f=this.startIndices[c],h=this.startIndicesFeature[c],void 0===i[r.default.getUid(h).toString()]&&h.getGeometry()&&(void 0===s||a.default.intersects(s,h.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,f,d);var p=n(h);if(p)return p}d=f,c--}},h.prototype.finish=function(t){this.anchorX=void 0,this.anchorY=void 0,this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.indices=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.vertices=null,this.width=void 0},h.prototype.getTextures=function(t){},h.prototype.getHitDetectionTextures=function(){},e.default=h},1359:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"}},1360:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=v(i(1)),a=v(i(28)),n=v(i(142)),s=v(i(11)),o=v(i(230)),l=v(i(121)),u=v(i(1371)),f=v(i(18)),d=v(i(1351)),h=v(i(1350)),c=v(i(1372)),_=v(i(1373)),p=v(i(553)),g=v(i(1347));function v(t){return t&&t.__esModule?t:{default:t}}var y=function(t,e){h.default.call(this,t,e),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0,changed:!1}};r.default.inherits(y,h.default),y.prototype.drawCoordinates_=function(t,e,i,r){var n,s,l,f,h,c,_,p,g=this.vertices.length,v=this.indices.length,x="bevel"===this.state_.lineJoin?0:"miter"===this.state_.lineJoin?1:2,m="butt"===this.state_.lineCap?0:"square"===this.state_.lineCap?1:2,E=u.default.lineStringIsClosed(t,e,i,r),C=v,T=1;for(n=e,s=i;n<s;n+=r){if(h=g/7,c=_,_=p||[t[n],t[n+1]],n===e){if(p=[t[n+r],t[n+r+1]],i-e==2*r&&a.default.equals(_,p))break;if(!E){m&&(g=this.addVertices_([0,0],_,p,T*y.Instruction_.BEGIN_LINE_CAP*m,g),g=this.addVertices_([0,0],_,p,-T*y.Instruction_.BEGIN_LINE_CAP*m,g),this.indices[v++]=h+2,this.indices[v++]=h,this.indices[v++]=h+1,this.indices[v++]=h+1,this.indices[v++]=h+3,this.indices[v++]=h+2),g=this.addVertices_([0,0],_,p,T*y.Instruction_.BEGIN_LINE*(m||1),g),C=(g=this.addVertices_([0,0],_,p,-T*y.Instruction_.BEGIN_LINE*(m||1),g))/7-1;continue}c=[t[i-2*r],t[i-2*r+1]],l=p}else{if(n===i-r){if(E){p=l;break}c=c||[0,0],g=this.addVertices_(c,_,[0,0],T*y.Instruction_.END_LINE*(m||1),g),g=this.addVertices_(c,_,[0,0],-T*y.Instruction_.END_LINE*(m||1),g),this.indices[v++]=h,this.indices[v++]=C-1,this.indices[v++]=C,this.indices[v++]=C,this.indices[v++]=h+1,this.indices[v++]=h,m&&(g=this.addVertices_(c,_,[0,0],T*y.Instruction_.END_LINE_CAP*m,g),g=this.addVertices_(c,_,[0,0],-T*y.Instruction_.END_LINE_CAP*m,g),this.indices[v++]=h+2,this.indices[v++]=h,this.indices[v++]=h+1,this.indices[v++]=h+1,this.indices[v++]=h+3,this.indices[v++]=h+2);break}p=[t[n+r],t[n+r+1]]}f=d.default.triangleIsCounterClockwise(c[0],c[1],_[0],_[1],p[0],p[1])?-1:1,g=this.addVertices_(c,_,p,f*y.Instruction_.BEVEL_FIRST*(x||1),g),g=this.addVertices_(c,_,p,f*y.Instruction_.BEVEL_SECOND*(x||1),g),g=this.addVertices_(c,_,p,-f*y.Instruction_.MITER_BOTTOM*(x||1),g),n>e&&(this.indices[v++]=h,this.indices[v++]=C-1,this.indices[v++]=C,this.indices[v++]=h+2,this.indices[v++]=h,this.indices[v++]=T*f>0?C:C-1),this.indices[v++]=h,this.indices[v++]=h+2,this.indices[v++]=h+1,C=h+2,T=f,x&&(g=this.addVertices_(c,_,p,f*y.Instruction_.MITER_TOP*x,g),this.indices[v++]=h+1,this.indices[v++]=h+3,this.indices[v++]=h)}E&&(h=h||g/7,f=o.default.linearRingIsClockwise([c[0],c[1],_[0],_[1],p[0],p[1]],0,6,2)?1:-1,g=this.addVertices_(c,_,p,f*y.Instruction_.BEVEL_FIRST*(x||1),g),g=this.addVertices_(c,_,p,-f*y.Instruction_.MITER_BOTTOM*(x||1),g),this.indices[v++]=h,this.indices[v++]=C-1,this.indices[v++]=C,this.indices[v++]=h+1,this.indices[v++]=h,this.indices[v++]=T*f>0?C:C-1)},y.prototype.addVertices_=function(t,e,i,r,a){return this.vertices[a++]=t[0],this.vertices[a++]=t[1],this.vertices[a++]=e[0],this.vertices[a++]=e[1],this.vertices[a++]=i[0],this.vertices[a++]=i[1],this.vertices[a++]=r,a},y.prototype.isValid_=function(t,e,i,r){var n=i-e;if(n<2*r)return!1;if(n===2*r){var s=[t[e],t[e+1]],o=[t[e+r],t[e+r+1]];return!a.default.equals(s,o)}return!0},y.prototype.drawLineString=function(t,e){var i=t.getFlatCoordinates(),r=t.getStride();this.isValid_(i,0,i.length,r)&&(i=l.default.translate(i,0,i.length,r,-this.origin[0],-this.origin[1]),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.drawCoordinates_(i,0,i.length,r))},y.prototype.drawMultiLineString=function(t,e){var i=this.indices.length,r=t.getEnds();r.unshift(0);var a,n,s=t.getFlatCoordinates(),o=t.getStride();if(r.length>1)for(a=1,n=r.length;a<n;++a)if(this.isValid_(s,r[a-1],r[a],o)){var u=l.default.translate(s,r[a-1],r[a],o,-this.origin[0],-this.origin[1]);this.drawCoordinates_(u,0,u.length,o)}this.indices.length>i&&(this.startIndices.push(i),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(i),this.state_.changed=!1))},y.prototype.drawPolygonCoordinates=function(t,e,i){var r,a;if(u.default.lineStringIsClosed(t,0,t.length,i)||(t.push(t[0]),t.push(t[1])),this.drawCoordinates_(t,0,t.length,i),e.length)for(r=0,a=e.length;r<a;++r)u.default.lineStringIsClosed(e[r],0,e[r].length,i)||(e[r].push(e[r][0]),e[r].push(e[r][1])),this.drawCoordinates_(e[r],0,e[r].length,i)},y.prototype.setPolygonStyle=function(t,e){var i=void 0===e?this.indices.length:e;this.startIndices.push(i),this.startIndicesFeature.push(t),this.state_.changed&&(this.styleIndices_.push(i),this.state_.changed=!1)},y.prototype.getCurrentIndex=function(){return this.indices.length},y.prototype.finish=function(t){this.verticesBuffer=new g.default(this.vertices),this.indicesBuffer=new g.default(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},y.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(i)}},y.prototype.setUpProgram=function(t,e,i,r){var a,n;a=c.default.fragment,n=c.default.vertex;var s,o=e.getProgram(a,n);return this.defaultLocations_?s=this.defaultLocations_:(s=new _.default(t,o),this.defaultLocations_=s),e.useProgram(o),t.enableVertexAttribArray(s.a_lastPos),t.vertexAttribPointer(s.a_lastPos,2,p.default.FLOAT,!1,28,0),t.enableVertexAttribArray(s.a_position),t.vertexAttribPointer(s.a_position,2,p.default.FLOAT,!1,28,8),t.enableVertexAttribArray(s.a_nextPos),t.vertexAttribPointer(s.a_nextPos,2,p.default.FLOAT,!1,28,16),t.enableVertexAttribArray(s.a_direction),t.vertexAttribPointer(s.a_direction,1,p.default.FLOAT,!1,28,24),t.uniform2fv(s.u_size,i),t.uniform1f(s.u_pixelRatio,r),s},y.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_lastPos),t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_nextPos),t.disableVertexAttribArray(e.a_direction)},y.prototype.drawReplay=function(t,e,i,r){var a,n,s,o,l=t.getParameter(t.DEPTH_FUNC),u=t.getParameter(t.DEPTH_WRITEMASK);if(r||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),f.default.isEmpty(i))for(s=this.startIndices[this.startIndices.length-1],a=this.styleIndices_.length-1;a>=0;--a)n=this.styleIndices_[a],o=this.styles_[a],this.setStrokeStyle_(t,o[0],o[1],o[2]),this.drawElements(t,e,n,s),t.clear(t.DEPTH_BUFFER_BIT),s=n;else this.drawReplaySkipping_(t,e,i);r||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(u),t.depthFunc(l))},y.prototype.drawReplaySkipping_=function(t,e,i){var a,n,s,o,l,u,f,d;for(f=this.startIndices.length-2,s=n=this.startIndices[f+1],a=this.styleIndices_.length-1;a>=0;--a){for(o=this.styles_[a],this.setStrokeStyle_(t,o[0],o[1],o[2]),l=this.styleIndices_[a];f>=0&&this.startIndices[f]>=l;)d=this.startIndices[f],u=this.startIndicesFeature[f],i[r.default.getUid(u).toString()]&&(n!==s&&(this.drawElements(t,e,n,s),t.clear(t.DEPTH_BUFFER_BIT)),s=d),f--,n=d;n!==s&&(this.drawElements(t,e,n,s),t.clear(t.DEPTH_BUFFER_BIT)),n=s=l}},y.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,a,n){var o,l,u,f,d,h,c;for(c=this.startIndices.length-2,u=this.startIndices[c+1],o=this.styleIndices_.length-1;o>=0;--o)for(f=this.styles_[o],this.setStrokeStyle_(t,f[0],f[1],f[2]),d=this.styleIndices_[o];c>=0&&this.startIndices[c]>=d;){if(l=this.startIndices[c],h=this.startIndicesFeature[c],void 0===i[r.default.getUid(h).toString()]&&h.getGeometry()&&(void 0===n||s.default.intersects(n,h.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,l,u);var _=a(h);if(_)return _}c--,u=l}},y.prototype.setStrokeStyle_=function(t,e,i,r){t.uniform4fv(this.defaultLocations_.u_color,e),t.uniform1f(this.defaultLocations_.u_lineWidth,i),t.uniform1f(this.defaultLocations_.u_miterLimit,r)},y.prototype.setFillStrokeStyle=function(t,e){var i=e.getLineCap();this.state_.lineCap=void 0!==i?i:d.default.defaultLineCap;var r=e.getLineDash();this.state_.lineDash=r||d.default.defaultLineDash;var s=e.getLineDashOffset();this.state_.lineDashOffset=s||d.default.defaultLineDashOffset;var o=e.getLineJoin();this.state_.lineJoin=void 0!==o?o:d.default.defaultLineJoin;var l=e.getColor();l=l instanceof CanvasGradient||l instanceof CanvasPattern?d.default.defaultStrokeStyle:n.default.asArray(l).map(function(t,e){return 3!=e?t/255:t})||d.default.defaultStrokeStyle;var u=e.getWidth();u=void 0!==u?u:d.default.defaultLineWidth;var f=e.getMiterLimit();f=void 0!==f?f:d.default.defaultMiterLimit,this.state_.strokeColor&&a.default.equals(this.state_.strokeColor,l)&&this.state_.lineWidth===u&&this.state_.miterLimit===f||(this.state_.changed=!0,this.state_.strokeColor=l,this.state_.lineWidth=u,this.state_.miterLimit=f,this.styles_.push([l,u,f]))},y.Instruction_={ROUND:2,BEGIN_LINE:3,END_LINE:5,BEGIN_LINE_CAP:7,END_LINE_CAP:11,BEVEL_FIRST:13,BEVEL_SECOND:17,MITER_BOTTOM:19,MITER_TOP:23},e.default=y},1361:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=_(i(1)),a=_(i(98)),n=_(i(66)),s=_(i(38)),o=_(i(11)),l=_(i(51)),u=_(i(120)),f=_(i(1353)),d=_(i(47)),h=_(i(553)),c=_(i(1352));function _(t){return t&&t.__esModule?t:{default:t}}var p=function(t,e){f.default.call(this,t,e),this.image_=null,this.hitCanvasContext_=null,this.hitTransformationMatrix_=null};r.default.inherits(p,f.default),p.handles=function(t,e){return t===u.default.WEBGL&&e.getType()===a.default.IMAGE},p.create=function(t,e){return new p(t,e)},p.prototype.createTexture_=function(t){var e=t.getImage(),i=this.mapRenderer.getGL();return c.default.createTexture(i,e,h.default.CLAMP_TO_EDGE,h.default.CLAMP_TO_EDGE)},p.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,a){var n=this.getLayer(),s=n.getSource(),o=e.viewState.resolution,l=e.viewState.rotation,u=e.skippedFeatureUids;return s.forEachFeatureAtCoordinate(t,o,l,i,u,function(t){return r.call(a,t,n)})},p.prototype.prepareFrame=function(t,e,i){var a=this.mapRenderer.getGL(),s=t.pixelRatio,l=t.viewState,u=l.center,f=l.resolution,h=l.rotation,c=this.image_,_=this.texture,p=this.getLayer().getSource(),g=t.viewHints,v=t.extent;if(void 0!==e.extent&&(v=o.default.getIntersection(v,e.extent)),!g[n.default.ANIMATING]&&!g[n.default.INTERACTING]&&!o.default.isEmpty(v)){var y=l.projection;if(!r.default.ENABLE_RASTER_REPROJECTION){var x=p.getProjection();x&&(y=x)}var m=p.getImage(v,f,s,y);if(m)if(this.loadImage(m)&&(c=m,_=this.createTexture_(m),this.texture)){var E=function(t,e){t.isContextLost()||t.deleteTexture(e)}.bind(null,a,this.texture);t.postRenderFunctions.push(E)}}if(c){var C=this.mapRenderer.getContext().getCanvas();this.updateProjectionMatrix_(C.width,C.height,s,u,f,h,c.getExtent()),this.hitTransformationMatrix_=null;var T=this.texCoordMatrix;d.default.reset(T),d.default.scale(T,1,-1),d.default.translate(T,0,-1),this.image_=c,this.texture=_,this.updateLogos(t,p)}return!!c},p.prototype.updateProjectionMatrix_=function(t,e,i,r,a,n,s){var o=t*a,l=e*a,u=this.projectionMatrix;d.default.reset(u),d.default.scale(u,2*i/o,2*i/l),d.default.rotate(u,-n),d.default.translate(u,s[0]-r[0],s[1]-r[1]),d.default.scale(u,(s[2]-s[0])/2,(s[3]-s[1])/2),d.default.translate(u,1,1)},p.prototype.hasFeatureAtCoordinate=function(t,e){return void 0!==this.forEachFeatureAtCoordinate(t,e,0,l.default.TRUE,this)},p.prototype.forEachLayerAtPixel=function(t,e,i,a){if(this.image_&&this.image_.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==r.default.nullFunction){var n=d.default.apply(e.pixelToCoordinateTransform,t.slice());return this.forEachFeatureAtCoordinate(n,e,0,l.default.TRUE,this)?i.call(a,this.getLayer(),null):void 0}var o=[this.image_.getImage().width,this.image_.getImage().height];this.hitTransformationMatrix_||(this.hitTransformationMatrix_=this.getHitTransformationMatrix_(e.size,o));var u=d.default.apply(this.hitTransformationMatrix_,t.slice());if(!(u[0]<0||u[0]>o[0]||u[1]<0||u[1]>o[1])){this.hitCanvasContext_||(this.hitCanvasContext_=s.default.createCanvasContext2D(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.image_.getImage(),u[0],u[1],1,1,0,0,1,1);var f=this.hitCanvasContext_.getImageData(0,0,1,1).data;return f[3]>0?i.call(a,this.getLayer(),f):void 0}}},p.prototype.getHitTransformationMatrix_=function(t,e){var i=d.default.create();d.default.translate(i,-1,-1),d.default.scale(i,2/t[0],2/t[1]),d.default.translate(i,0,t[1]),d.default.scale(i,1,-1);var r=d.default.invert(this.projectionMatrix.slice()),a=d.default.create();return d.default.translate(a,0,e[1]),d.default.scale(a,1,-1),d.default.scale(a,e[0]/2,e[1]/2),d.default.translate(a,1,1),d.default.multiply(a,r),d.default.multiply(a,i),a},e.default=p},1362:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=p(i(1)),a=p(i(28)),n=p(i(142)),s=p(i(11)),o=p(i(18)),l=p(i(121)),u=p(i(1363)),f=p(i(1364)),d=p(i(1350)),h=p(i(1351)),c=p(i(553)),_=p(i(1347));function p(t){return t&&t.__esModule?t:{default:t}}var g=function(t,e){d.default.call(this,t,e),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.radius_=0,this.state_={fillColor:null,strokeColor:null,lineDash:null,lineDashOffset:void 0,lineWidth:void 0,changed:!1}};r.default.inherits(g,d.default),g.prototype.drawCoordinates_=function(t,e,i,r){var a,n,s=this.vertices.length,o=this.indices.length,l=s/4;for(a=e,n=i;a<n;a+=r)this.vertices[s++]=t[a],this.vertices[s++]=t[a+1],this.vertices[s++]=0,this.vertices[s++]=this.radius_,this.vertices[s++]=t[a],this.vertices[s++]=t[a+1],this.vertices[s++]=1,this.vertices[s++]=this.radius_,this.vertices[s++]=t[a],this.vertices[s++]=t[a+1],this.vertices[s++]=2,this.vertices[s++]=this.radius_,this.vertices[s++]=t[a],this.vertices[s++]=t[a+1],this.vertices[s++]=3,this.vertices[s++]=this.radius_,this.indices[o++]=l,this.indices[o++]=l+1,this.indices[o++]=l+2,this.indices[o++]=l+2,this.indices[o++]=l+3,this.indices[o++]=l,l+=4},g.prototype.drawCircle=function(t,e){var i=t.getRadius(),r=t.getStride();if(i){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.radius_=i;var a=t.getFlatCoordinates();a=l.default.translate(a,0,2,r,-this.origin[0],-this.origin[1]),this.drawCoordinates_(a,0,2,r)}else if(this.state_.changed&&(this.styles_.pop(),this.styles_.length)){var n=this.styles_[this.styles_.length-1];this.state_.fillColor=n[0],this.state_.strokeColor=n[1],this.state_.lineWidth=n[2],this.state_.changed=!1}},g.prototype.finish=function(t){this.verticesBuffer=new _.default(this.vertices),this.indicesBuffer=new _.default(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},g.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(i)}},g.prototype.setUpProgram=function(t,e,i,r){var a,n;a=u.default.fragment,n=u.default.vertex;var s,o=e.getProgram(a,n);return this.defaultLocations_?s=this.defaultLocations_:(s=new f.default(t,o),this.defaultLocations_=s),e.useProgram(o),t.enableVertexAttribArray(s.a_position),t.vertexAttribPointer(s.a_position,2,c.default.FLOAT,!1,16,0),t.enableVertexAttribArray(s.a_instruction),t.vertexAttribPointer(s.a_instruction,1,c.default.FLOAT,!1,16,8),t.enableVertexAttribArray(s.a_radius),t.vertexAttribPointer(s.a_radius,1,c.default.FLOAT,!1,16,12),t.uniform2fv(s.u_size,i),t.uniform1f(s.u_pixelRatio,r),s},g.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_instruction),t.disableVertexAttribArray(e.a_radius)},g.prototype.drawReplay=function(t,e,i,r){var a,n,s,l;if(o.default.isEmpty(i))for(s=this.startIndices[this.startIndices.length-1],a=this.styleIndices_.length-1;a>=0;--a)n=this.styleIndices_[a],l=this.styles_[a],this.setFillStyle_(t,l[0]),this.setStrokeStyle_(t,l[1],l[2]),this.drawElements(t,e,n,s),s=n;else this.drawReplaySkipping_(t,e,i)},g.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,a,n){var o,l,u,f,d,h,c;for(c=this.startIndices.length-2,u=this.startIndices[c+1],o=this.styleIndices_.length-1;o>=0;--o)for(f=this.styles_[o],this.setFillStyle_(t,f[0]),this.setStrokeStyle_(t,f[1],f[2]),d=this.styleIndices_[o];c>=0&&this.startIndices[c]>=d;){if(l=this.startIndices[c],h=this.startIndicesFeature[c],void 0===i[r.default.getUid(h).toString()]&&h.getGeometry()&&(void 0===n||s.default.intersects(n,h.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,l,u);var _=a(h);if(_)return _}c--,u=l}},g.prototype.drawReplaySkipping_=function(t,e,i){var a,n,s,o,l,u,f,d;for(f=this.startIndices.length-2,s=n=this.startIndices[f+1],a=this.styleIndices_.length-1;a>=0;--a){for(o=this.styles_[a],this.setFillStyle_(t,o[0]),this.setStrokeStyle_(t,o[1],o[2]),l=this.styleIndices_[a];f>=0&&this.startIndices[f]>=l;)d=this.startIndices[f],u=this.startIndicesFeature[f],i[r.default.getUid(u).toString()]&&(n!==s&&this.drawElements(t,e,n,s),s=d),f--,n=d;n!==s&&this.drawElements(t,e,n,s),n=s=l}},g.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_fillColor,e)},g.prototype.setStrokeStyle_=function(t,e,i){t.uniform4fv(this.defaultLocations_.u_strokeColor,e),t.uniform1f(this.defaultLocations_.u_lineWidth,i)},g.prototype.setFillStrokeStyle=function(t,e){var i,r;if(e){var s=e.getLineDash();this.state_.lineDash=s||h.default.defaultLineDash;var o=e.getLineDashOffset();this.state_.lineDashOffset=o||h.default.defaultLineDashOffset,i=(i=e.getColor())instanceof CanvasGradient||i instanceof CanvasPattern?h.default.defaultStrokeStyle:n.default.asArray(i).map(function(t,e){return 3!=e?t/255:t})||h.default.defaultStrokeStyle,r=void 0!==(r=e.getWidth())?r:h.default.defaultLineWidth}else i=[0,0,0,0],r=0;var l=t?t.getColor():[0,0,0,0];l=l instanceof CanvasGradient||l instanceof CanvasPattern?h.default.defaultFillStyle:n.default.asArray(l).map(function(t,e){return 3!=e?t/255:t})||h.default.defaultFillStyle,this.state_.strokeColor&&a.default.equals(this.state_.strokeColor,i)&&this.state_.fillColor&&a.default.equals(this.state_.fillColor,l)&&this.state_.lineWidth===r||(this.state_.changed=!0,this.state_.fillColor=l,this.state_.strokeColor=i,this.state_.lineWidth=r,this.styles_.push([l,i,r]))},e.default=g},1363:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(i(1)),a=s(i(1348)),n=s(i(1349));function s(t){return t&&t.__esModule?t:{default:t}}var o={};o.fragment=new a.default(r.default.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_fillColor;\nuniform vec4 u_strokeColor;\nuniform vec2 u_size;\n\nvoid main(void) {\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  float radius = length(windowCenter - windowOffset);\n  float dist = length(windowCenter - gl_FragCoord.xy);\n  if (dist > radius + v_halfWidth) {\n    if (u_strokeColor.a == 0.0) {\n      gl_FragColor = u_fillColor;\n    } else {\n      gl_FragColor = u_strokeColor;\n    }\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\n  } else if (u_fillColor.a == 0.0) {\n    // Hooray, no fill, just stroke. We can use real antialiasing.\n    gl_FragColor = u_strokeColor;\n    if (dist < radius - v_halfWidth) {\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\n    }\n  } else {\n    gl_FragColor = u_fillColor;\n    float strokeDist = radius - v_halfWidth;\n    float antialias = 2.0 * v_pixelRatio;\n    if (dist > strokeDist) {\n      gl_FragColor = u_strokeColor;\n    } else if (dist >= strokeDist - antialias) {\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\n    }\n  }\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\n  if (gl_FragColor.a <= 0.0) {\n    discard;\n  }\n}\n":"precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}"),o.vertex=new n.default(r.default.DEBUG_WEBGL?"varying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\nattribute vec2 a_position;\nattribute float a_instruction;\nattribute float a_radius;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\n  v_pixelRatio = u_pixelRatio;\n  float lineWidth = u_lineWidth * u_pixelRatio;\n  v_halfWidth = lineWidth / 2.0;\n  if (lineWidth == 0.0) {\n    lineWidth = 2.0 * u_pixelRatio;\n  }\n  vec2 offset;\n  // Radius with anitaliasing (roughly).\n  float radius = a_radius + 3.0 * u_pixelRatio;\n  // Until we get gl_VertexID in WebGL, we store an instruction.\n  if (a_instruction == 0.0) {\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\n    offset = vec2(-1.0, 1.0);\n  } else if (a_instruction == 1.0) {\n    offset = vec2(-1.0, -1.0);\n  } else if (a_instruction == 2.0) {\n    offset = vec2(1.0, -1.0);\n  } else {\n    offset = vec2(1.0, 1.0);\n  }\n\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\n      0.0, 1.0)).xy;\n\n  if (distance(v_center, v_offset) > 20000.0) {\n    gl_Position = vec4(v_center, 0.0, 1.0);\n  }\n}\n\n\n":"varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;//Until we get gl_VertexID in WebGL,we store an instruction.if(f==0.0){//Offsetting the edges of the triangle by lineWidth/2 is necessary,however//we should also leave some space for the antialiasing,thus we offset by lineWidth.offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}"),e.default=o},1364:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,a=i(1),n=(r=a)&&r.__esModule?r:{default:r};e.default=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_offsetRotateMatrix":"j"),this.u_lineWidth=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_lineWidth":"k"),this.u_pixelRatio=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_pixelRatio":"l"),this.u_opacity=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_opacity":"m"),this.u_fillColor=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_fillColor":"n"),this.u_strokeColor=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_strokeColor":"o"),this.u_size=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_size":"p"),this.a_position=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_position":"e"),this.a_instruction=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_instruction":"f"),this.a_radius=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_radius":"g")}},1365:function(t,e,i){t.exports={default:i(1366),__esModule:!0}},1366:function(t,e,i){i(1367),t.exports=Math.pow(2,-52)},1367:function(t,e,i){var r=i(39);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},1368:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(i(1)),a=s(i(1358)),n=s(i(1347));function s(t){return t&&t.__esModule?t:{default:t}}var o=function(t,e){a.default.call(this,t,e),this.images_=[],this.hitDetectionImages_=[],this.textures_=[],this.hitDetectionTextures_=[]};r.default.inherits(o,a.default),o.prototype.drawMultiPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var i=t.getFlatCoordinates(),r=t.getStride();this.drawCoordinates(i,0,i.length,r)},o.prototype.drawPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var i=t.getFlatCoordinates(),r=t.getStride();this.drawCoordinates(i,0,i.length,r)},o.prototype.finish=function(t){var e=t.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices.push(this.indices.length),this.verticesBuffer=new n.default(this.vertices);var i=this.indices;this.indicesBuffer=new n.default(i);var r={};this.createTextures(this.textures_,this.images_,r,e),this.createTextures(this.hitDetectionTextures_,this.hitDetectionImages_,r,e),this.images_=null,this.hitDetectionImages_=null,a.default.prototype.finish.call(this,t)},o.prototype.setImageStyle=function(t){var e,i=t.getAnchor(),a=t.getImage(1),n=t.getImageSize(),s=t.getHitDetectionImage(1),o=t.getOpacity(),l=t.getOrigin(),u=t.getRotateWithView(),f=t.getRotation(),d=t.getSize(),h=t.getScale();0===this.images_.length?this.images_.push(a):(e=this.images_[this.images_.length-1],r.default.getUid(e)!=r.default.getUid(a)&&(this.groupIndices.push(this.indices.length),this.images_.push(a))),0===this.hitDetectionImages_.length?this.hitDetectionImages_.push(s):(e=this.hitDetectionImages_[this.hitDetectionImages_.length-1],r.default.getUid(e)!=r.default.getUid(s)&&(this.hitDetectionGroupIndices.push(this.indices.length),this.hitDetectionImages_.push(s))),this.anchorX=i[0],this.anchorY=i[1],this.height=d[1],this.imageHeight=n[1],this.imageWidth=n[0],this.opacity=o,this.originX=l[0],this.originY=l[1],this.rotation=f,this.rotateWithView=u,this.scale=h,this.width=d[0]},o.prototype.getTextures=function(t){return t?this.textures_.concat(this.hitDetectionTextures_):this.textures_},o.prototype.getHitDetectionTextures=function(){return this.hitDetectionTextures_},e.default=o},1369:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(i(1)),a=s(i(1348)),n=s(i(1349));function s(t){return t&&t.__esModule?t:{default:t}}var o={};o.fragment=new a.default(r.default.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),o.vertex=new n.default(r.default.DEBUG_WEBGL?"varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n":"varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}"),e.default=o},1370:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,a=i(1),n=(r=a)&&r.__esModule?r:{default:r};e.default=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_offsetRotateMatrix":"j"),this.u_opacity=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_opacity":"k"),this.u_image=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_image":"l"),this.a_position=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_position":"c"),this.a_texCoord=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_texCoord":"d"),this.a_offsets=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_offsets":"e"),this.a_opacity=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_opacity":"f"),this.a_rotateWithView=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_rotateWithView":"g")}},1371:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,a=i(233),n=(r=a)&&r.__esModule?r:{default:r};var s={lineStringIsClosed:function(t,e,i,r){var a=i-r;return t[e]===t[a]&&t[e+1]===t[a+1]&&(i-e)/r>3&&!!n.default.linearRing(t,e,i,r)}};e.default=s},1372:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(i(1)),a=s(i(1348)),n=s(i(1349));function s(t){return t&&t.__esModule?t:{default:t}}var o={};o.fragment=new a.default(r.default.DEBUG_WEBGL?"precision mediump float;\nvarying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_color;\nuniform vec2 u_size;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  if (v_round > 0.0) {\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying float a;varying vec2 aVertex;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((aVertex.x+1.0)/2.0*o.x*p,(aVertex.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),o.vertex=new n.default(r.default.DEBUG_WEBGL?"varying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\nattribute vec2 a_lastPos;\nattribute vec2 a_position;\nattribute vec2 a_nextPos;\nattribute float a_direction;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_miterLimit;\n\nbool nearlyEquals(in float value, in float ref) {\n  float epsilon = 0.000000000001;\n  return value >= ref - epsilon && value <= ref + epsilon;\n}\n\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\n  vec2 dirVect = nextP - a_position;\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\n  offset = u_lineWidth / 2.0 * normal * direction;\n}\n\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\n  float halfWidth = u_lineWidth / 2.0;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_nextPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n  offset = normal * direction * miterLength;\n  round = 0.0;\n  if (isRound) {\n    round = 1.0;\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\n    offset = halfWidth * tmpNormal * direction;\n  }\n}\n\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\n  bool degenerate = false;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_lastPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  vec2 longOffset, shortOffset, longVertex;\n  vec4 shortProjVertex;\n  float halfWidth = u_lineWidth / 2.0;\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\n    longOffset = tmpNormal * direction * halfWidth;\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_nextPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\n  } else {\n    shortOffset = tmpNormal * direction * halfWidth;\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_lastPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\n  }\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\n  float epsilon = 0.000000000001;\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\n    offset = shortProjVertex.xy;\n    degenerate = true;\n  } else {\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n    offset = normal * direction * miterLength;\n  }\n  return degenerate;\n}\n\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\n    in float turnDir, in float direction) {\n  round = 0.0;\n  vec2 dirVect = a_position - nextP;\n  vec2 firstNormal = normalize(dirVect);\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\n  offset = normal * length;\n  if (isRound) {\n    round = 1.0;\n  }\n}\n\nvoid main(void) {\n  bool degenerate = false;\n  float direction = float(sign(a_direction));\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  vec2 offset;\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\n\n  v_round = 0.0;\n  v_halfWidth = u_lineWidth / 2.0;\n  v_roundVertex = projPos.xy;\n\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\n    alongNormal(offset, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\n    alongNormal(offset, a_lastPos, -1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\n    miterUp(offset, v_round, round, direction);\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\n  }\n  if (!degenerate) {\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\n    gl_Position = projPos + offsets;\n  } else {\n    gl_Position = vec4(offset, 0.0, 1.0);\n  }\n}\n\n\n":"varying float a;varying vec2 aVertex;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;aVertex=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}"),e.default=o},1373:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,a=i(1),n=(r=a)&&r.__esModule?r:{default:r};e.default=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_offsetRotateMatrix":"j"),this.u_lineWidth=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_lineWidth":"k"),this.u_miterLimit=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_miterLimit":"l"),this.u_opacity=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_opacity":"m"),this.u_color=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_color":"n"),this.u_size=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_size":"o"),this.u_pixelRatio=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_pixelRatio":"p"),this.a_lastPos=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_lastPos":"d"),this.a_position=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_position":"e"),this.a_nextPos=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_nextPos":"f"),this.a_direction=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_direction":"g")}},1374:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=C(i(29)),a=C(i(1)),n=C(i(28)),s=C(i(142)),o=C(i(11)),l=C(i(18)),u=C(i(179)),f=C(i(230)),d=C(i(121)),h=C(i(1375)),c=C(i(1376)),_=C(i(1360)),p=C(i(1350)),g=C(i(1351)),v=C(i(330)),y=C(i(1377)),x=C(i(564)),m=C(i(553)),E=C(i(1347));function C(t){return t&&t.__esModule?t:{default:t}}var T=function(t,e){p.default.call(this,t,e),this.lineStringReplay=new _.default(t,e),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={fillColor:null,changed:!1}};a.default.inherits(T,p.default),T.prototype.drawCoordinates_=function(t,e,i){var r=new y.default,a=new x.default;this.processFlatCoordinates_(t,i,r,a,!0);var n=this.getMaxCoords_(r);if(e.length){var s,o,l=[];for(s=0,o=e.length;s<o;++s){var u={list:new y.default,maxCoords:void 0,rtree:new x.default};l.push(u),this.processFlatCoordinates_(e[s],i,u.list,u.rtree,!1),this.classifyPoints_(u.list,u.rtree,!0),u.maxCoords=this.getMaxCoords_(u.list)}for(l.sort(function(t,e){return e.maxCoords[0]===t.maxCoords[0]?t.maxCoords[1]-e.maxCoords[1]:e.maxCoords[0]-t.maxCoords[0]}),s=0;s<l.length;++s){var f,d=l[s].list,h=d.firstItem(),c=h;do{if(this.getIntersections_(c,a).length){f=!0;break}c=d.nextItem()}while(h!==c);f||this.bridgeHole_(d,l[s].maxCoords[0],r,n[0],a)&&(a.concat(l[s].rtree),this.classifyPoints_(r,a,!1))}}else this.classifyPoints_(r,a,!1);this.triangulate_(r,a)},T.prototype.processFlatCoordinates_=function(t,e,i,r,a){var n,s,o,l,u,d=f.default.linearRingIsClockwise(t,0,t.length,e),h=this.vertices.length/2,c=[],_=[];if(a===d){for(l=o=this.createPoint_(t[0],t[1],h++),n=e,s=t.length;n<s;n+=e)u=this.createPoint_(t[n],t[n+1],h++),_.push(this.insertItem_(l,u,i)),c.push([Math.min(l.x,u.x),Math.min(l.y,u.y),Math.max(l.x,u.x),Math.max(l.y,u.y)]),l=u;_.push(this.insertItem_(u,o,i)),c.push([Math.min(l.x,u.x),Math.min(l.y,u.y),Math.max(l.x,u.x),Math.max(l.y,u.y)])}else{var p=t.length-e;for(l=o=this.createPoint_(t[p],t[p+1],h++),n=p-e,s=0;n>=s;n-=e)u=this.createPoint_(t[n],t[n+1],h++),_.push(this.insertItem_(l,u,i)),c.push([Math.min(l.x,u.x),Math.min(l.y,u.y),Math.max(l.x,u.x),Math.max(l.y,u.y)]),l=u;_.push(this.insertItem_(u,o,i)),c.push([Math.min(l.x,u.x),Math.min(l.y,u.y),Math.max(l.x,u.x),Math.max(l.y,u.y)])}r.load(c,_)},T.prototype.getMaxCoords_=function(t){var e=t.firstItem(),i=e,r=[i.p0.x,i.p0.y];do{(i=t.nextItem()).p0.x>r[0]&&(r=[i.p0.x,i.p0.y])}while(i!==e);return r},T.prototype.classifyPoints_=function(t,e,i){var r=t.firstItem(),a=r,n=t.nextItem(),s=!1;do{var o=i?g.default.triangleIsCounterClockwise(n.p1.x,n.p1.y,a.p1.x,a.p1.y,a.p0.x,a.p0.y):g.default.triangleIsCounterClockwise(a.p0.x,a.p0.y,a.p1.x,a.p1.y,n.p1.x,n.p1.y);void 0===o?(this.removeItem_(a,n,t,e),s=!0,n===r&&(r=t.getNextItem()),n=a,t.prevItem()):a.p1.reflex!==o&&(a.p1.reflex=o,s=!0),a=n,n=t.nextItem()}while(a!==r);return s},T.prototype.bridgeHole_=function(t,e,i,r,a){for(var n=t.firstItem();n.p1.x!==e;)n=t.nextItem();var s,o,l,u,f=n.p1,d={x:r,y:f.y,i:-1},h=1/0,c=this.getIntersections_({p0:f,p1:d},a,!0);for(s=0,o=c.length;s<o;++s){var _=c[s],p=this.calculateIntersection_(f,d,_.p0,_.p1,!0),v=Math.abs(f.x-p[0]);v<h&&void 0!==g.default.triangleIsCounterClockwise(f.x,f.y,_.p0.x,_.p0.y,_.p1.x,_.p1.y)&&(h=v,u={x:p[0],y:p[1],i:-1},n=_)}if(h===1/0)return!1;if(l=n.p1,h>0){var y=this.getPointsInTriangle_(f,u,n.p1,a);if(y.length){var x=1/0;for(s=0,o=y.length;s<o;++s){var m=y[s],E=Math.atan2(f.y-m.y,d.x-m.x);(E<x||E===x&&m.x<l.x)&&(x=E,l=m)}}}for(n=i.firstItem();n.p1.x!==l.x||n.p1.y!==l.y;)n=i.nextItem();var C={x:f.x,y:f.y,i:f.i,reflex:void 0},T={x:n.p1.x,y:n.p1.y,i:n.p1.i,reflex:void 0};return t.getNextItem().p0=C,this.insertItem_(f,n.p1,t,a),this.insertItem_(T,C,t,a),n.p1=T,t.setFirstItem(),i.concat(t),!0},T.prototype.triangulate_=function(t,e){for(var i=!1,r=this.isSimple_(t,e);t.getLength()>3;)if(r){if(!this.clipEars_(t,e,r,i)&&!this.classifyPoints_(t,e,i)&&!this.resolveSelfIntersections_(t,e,!0))break}else if(!this.clipEars_(t,e,r,i)&&!this.classifyPoints_(t,e,i)&&!this.resolveSelfIntersections_(t,e)){if(!(r=this.isSimple_(t,e))){this.splitPolygon_(t,e);break}i=!this.isClockwise_(t),this.classifyPoints_(t,e,i)}if(3===t.getLength()){var a=this.indices.length;this.indices[a++]=t.getPrevItem().p0.i,this.indices[a++]=t.getCurrItem().p0.i,this.indices[a++]=t.getNextItem().p0.i}},T.prototype.clipEars_=function(t,e,i,r){var a,n,s,o=this.indices.length,l=t.firstItem(),u=t.getPrevItem(),d=l,h=t.nextItem(),c=t.getNextItem(),_=!1;do{var p;if(a=d.p0,n=d.p1,s=h.p1,!1===n.reflex)p=i?0===this.getPointsInTriangle_(a,n,s,e,!0).length:r?this.diagonalIsInside_(c.p1,s,n,a,u.p0):this.diagonalIsInside_(u.p0,a,n,s,c.p1),(i||0===this.getIntersections_({p0:a,p1:s},e).length)&&p&&(i||!1===a.reflex||!1===s.reflex||f.default.linearRingIsClockwise([u.p0.x,u.p0.y,a.x,a.y,n.x,n.y,s.x,s.y,c.p1.x,c.p1.y],0,10,2)===!r)&&(this.indices[o++]=a.i,this.indices[o++]=n.i,this.indices[o++]=s.i,this.removeItem_(d,h,t,e),h===l&&(l=c),_=!0);u=t.getPrevItem(),d=t.getCurrItem(),h=t.nextItem(),c=t.getNextItem()}while(d!==l&&t.getLength()>3);return _},T.prototype.resolveSelfIntersections_=function(t,e,i){var r=t.firstItem();t.nextItem();var a=r,n=t.nextItem(),s=!1;do{var o=this.calculateIntersection_(a.p0,a.p1,n.p0,n.p1,i);if(o){var l,u=!1,f=this.vertices.length,d=this.indices.length,h=f/2,c=t.prevItem();if(t.removeItem(),e.remove(c),u=c===r,i?(o[0]===a.p0.x&&o[1]===a.p0.y?(t.prevItem(),l=a.p0,n.p0=l,e.remove(a),u=u||a===r):(l=n.p1,a.p1=l,e.remove(n),u=u||n===r),t.removeItem()):(l=this.createPoint_(o[0],o[1],h),a.p1=l,n.p0=l,e.update([Math.min(a.p0.x,a.p1.x),Math.min(a.p0.y,a.p1.y),Math.max(a.p0.x,a.p1.x),Math.max(a.p0.y,a.p1.y)],a),e.update([Math.min(n.p0.x,n.p1.x),Math.min(n.p0.y,n.p1.y),Math.max(n.p0.x,n.p1.x),Math.max(n.p0.y,n.p1.y)],n)),this.indices[d++]=c.p0.i,this.indices[d++]=c.p1.i,this.indices[d++]=l.i,s=!0,u)break}a=t.getPrevItem(),n=t.nextItem()}while(a!==r);return s},T.prototype.isSimple_=function(t,e){var i=t.firstItem(),r=i;do{if(this.getIntersections_(r,e).length)return!1;r=t.nextItem()}while(r!==i);return!0},T.prototype.isClockwise_=function(t){var e=2*t.getLength(),i=new Array(e),r=t.firstItem(),a=r,n=0;do{i[n++]=a.p0.x,i[n++]=a.p0.y,a=t.nextItem()}while(a!==r);return f.default.linearRingIsClockwise(i,0,e,2)},T.prototype.splitPolygon_=function(t,e){var i=t.firstItem(),r=i;do{var a=this.getIntersections_(r,e);if(a.length){var n=a[0],s=this.vertices.length/2,o=this.calculateIntersection_(r.p0,r.p1,n.p0,n.p1),l=this.createPoint_(o[0],o[1],s),u=new y.default,f=new x.default;this.insertItem_(l,r.p1,u,f),r.p1=l,e.update([Math.min(r.p0.x,l.x),Math.min(r.p0.y,l.y),Math.max(r.p0.x,l.x),Math.max(r.p0.y,l.y)],r);for(var d=t.nextItem();d!==n;)this.insertItem_(d.p0,d.p1,u,f),e.remove(d),t.removeItem(),d=t.getCurrItem();this.insertItem_(n.p0,l,u,f),n.p0=l,e.update([Math.min(n.p1.x,l.x),Math.min(n.p1.y,l.y),Math.max(n.p1.x,l.x),Math.max(n.p1.y,l.y)],n),this.classifyPoints_(t,e,!1),this.triangulate_(t,e),this.classifyPoints_(u,f,!1),this.triangulate_(u,f);break}r=t.nextItem()}while(r!==i)},T.prototype.createPoint_=function(t,e,i){var r=this.vertices.length;return this.vertices[r++]=t,this.vertices[r++]=e,{x:t,y:e,i:i,reflex:void 0}},T.prototype.insertItem_=function(t,e,i,r){var a={p0:t,p1:e};return i.insertItem(a),r&&r.insert([Math.min(t.x,e.x),Math.min(t.y,e.y),Math.max(t.x,e.x),Math.max(t.y,e.y)],a),a},T.prototype.removeItem_=function(t,e,i,r){i.getCurrItem()===e&&(i.removeItem(),t.p1=e.p1,r.remove(e),r.update([Math.min(t.p0.x,t.p1.x),Math.min(t.p0.y,t.p1.y),Math.max(t.p0.x,t.p1.x),Math.max(t.p0.y,t.p1.y)],t))},T.prototype.getPointsInTriangle_=function(t,e,i,a,n){var s,o,l,f,d=[],h=a.getInExtent([Math.min(t.x,e.x,i.x),Math.min(t.y,e.y,i.y),Math.max(t.x,e.x,i.x),Math.max(t.y,e.y,i.y)]);for(s=0,o=h.length;s<o;++s)for(l in h[s])"object"!==(void 0===(f=h[s][l])?"undefined":(0,r.default)(f))||n&&!f.reflex||f.x===t.x&&f.y===t.y||f.x===e.x&&f.y===e.y||f.x===i.x&&f.y===i.y||-1!==d.indexOf(f)||!u.default.linearRingContainsXY([t.x,t.y,e.x,e.y,i.x,i.y],0,6,2,f.x,f.y)||d.push(f);return d},T.prototype.getIntersections_=function(t,e,i){var r,a,n=t.p0,s=t.p1,o=e.getInExtent([Math.min(n.x,s.x),Math.min(n.y,s.y),Math.max(n.x,s.x),Math.max(n.y,s.y)]),l=[];for(r=0,a=o.length;r<a;++r){var u=o[r];t!==u&&(i||u.p0!==s||u.p1!==n)&&this.calculateIntersection_(n,s,u.p0,u.p1,i)&&l.push(u)}return l},T.prototype.calculateIntersection_=function(t,e,i,r,a){var n=(r.y-i.y)*(e.x-t.x)-(r.x-i.x)*(e.y-t.y);if(0!==n){var s=((r.x-i.x)*(t.y-i.y)-(r.y-i.y)*(t.x-i.x))/n,o=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/n;if(!a&&s>g.default.EPSILON&&s<1-g.default.EPSILON&&o>g.default.EPSILON&&o<1-g.default.EPSILON||a&&s>=0&&s<=1&&o>=0&&o<=1)return[t.x+s*(e.x-t.x),t.y+s*(e.y-t.y)]}},T.prototype.diagonalIsInside_=function(t,e,i,r,a){if(void 0===e.reflex||void 0===r.reflex)return!1;var n=(i.x-r.x)*(e.y-r.y)>(i.y-r.y)*(e.x-r.x),s=(a.x-r.x)*(e.y-r.y)<(a.y-r.y)*(e.x-r.x),o=(t.x-e.x)*(r.y-e.y)>(t.y-e.y)*(r.x-e.x),l=(i.x-e.x)*(r.y-e.y)<(i.y-e.y)*(r.x-e.x),u=r.reflex?s||n:s&&n,f=e.reflex?l||o:l&&o;return u&&f},T.prototype.drawMultiPolygon=function(t,e){var i,r,a,n,s=t.getEndss(),o=t.getStride(),l=this.indices.length,u=this.lineStringReplay.getCurrentIndex(),f=t.getFlatCoordinates(),h=0;for(i=0,r=s.length;i<r;++i){var c=s[i];if(c.length>0){var _=d.default.translate(f,h,c[0],o,-this.origin[0],-this.origin[1]);if(_.length){var p,g=[];for(a=1,n=c.length;a<n;++a)c[a]!==c[a-1]&&(p=d.default.translate(f,c[a-1],c[a],o,-this.origin[0],-this.origin[1]),g.push(p));this.lineStringReplay.drawPolygonCoordinates(_,g,o),this.drawCoordinates_(_,g,o)}}h=c[c.length-1]}this.indices.length>l&&(this.startIndices.push(l),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(l),this.state_.changed=!1)),this.lineStringReplay.getCurrentIndex()>u&&this.lineStringReplay.setPolygonStyle(e,u)},T.prototype.drawPolygon=function(t,e){var i=t.getEnds(),r=t.getStride();if(i.length>0){var a=t.getFlatCoordinates().map(Number),n=d.default.translate(a,0,i[0],r,-this.origin[0],-this.origin[1]);if(n.length){var s,o,l,u=[];for(s=1,o=i.length;s<o;++s)i[s]!==i[s-1]&&(l=d.default.translate(a,i[s-1],i[s],r,-this.origin[0],-this.origin[1]),u.push(l));this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.lineStringReplay.setPolygonStyle(e),this.lineStringReplay.drawPolygonCoordinates(n,u,r),this.drawCoordinates_(n,u,r)}}},T.prototype.finish=function(t){this.verticesBuffer=new E.default(this.vertices),this.indicesBuffer=new E.default(this.indices),this.startIndices.push(this.indices.length),this.lineStringReplay.finish(t),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},T.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer,r=this.lineStringReplay.getDeleteResourcesFunction(t);return function(){t.deleteBuffer(e),t.deleteBuffer(i),r()}},T.prototype.setUpProgram=function(t,e,i,r){var a,n;a=h.default.fragment,n=h.default.vertex;var s,o=e.getProgram(a,n);return this.defaultLocations_?s=this.defaultLocations_:(s=new c.default(t,o),this.defaultLocations_=s),e.useProgram(o),t.enableVertexAttribArray(s.a_position),t.vertexAttribPointer(s.a_position,2,m.default.FLOAT,!1,8,0),s},T.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position)},T.prototype.drawReplay=function(t,e,i,r){var a,n,s,o,u=t.getParameter(t.DEPTH_FUNC),f=t.getParameter(t.DEPTH_WRITEMASK);if(r||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),l.default.isEmpty(i))for(s=this.startIndices[this.startIndices.length-1],a=this.styleIndices_.length-1;a>=0;--a)n=this.styleIndices_[a],o=this.styles_[a],this.setFillStyle_(t,o),this.drawElements(t,e,n,s),s=n;else this.drawReplaySkipping_(t,e,i);r||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(f),t.depthFunc(u))},T.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,n){var s,l,u,f,d,h,c;for(c=this.startIndices.length-2,u=this.startIndices[c+1],s=this.styleIndices_.length-1;s>=0;--s)for(f=this.styles_[s],this.setFillStyle_(t,f),d=this.styleIndices_[s];c>=0&&this.startIndices[c]>=d;){if(l=this.startIndices[c],h=this.startIndicesFeature[c],void 0===i[a.default.getUid(h).toString()]&&h.getGeometry()&&(void 0===n||o.default.intersects(n,h.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,l,u);var _=r(h);if(_)return _}c--,u=l}},T.prototype.drawReplaySkipping_=function(t,e,i){var r,n,s,o,l,u,f,d;for(f=this.startIndices.length-2,s=n=this.startIndices[f+1],r=this.styleIndices_.length-1;r>=0;--r){for(o=this.styles_[r],this.setFillStyle_(t,o),l=this.styleIndices_[r];f>=0&&this.startIndices[f]>=l;)d=this.startIndices[f],u=this.startIndicesFeature[f],i[a.default.getUid(u).toString()]&&(n!==s&&(this.drawElements(t,e,n,s),t.clear(t.DEPTH_BUFFER_BIT)),s=d),f--,n=d;n!==s&&(this.drawElements(t,e,n,s),t.clear(t.DEPTH_BUFFER_BIT)),n=s=l}},T.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_color,e)},T.prototype.setFillStrokeStyle=function(t,e){var i=t?t.getColor():[0,0,0,0];if(i=i instanceof CanvasGradient||i instanceof CanvasPattern?g.default.defaultFillStyle:s.default.asArray(i).map(function(t,e){return 3!=e?t/255:t})||g.default.defaultFillStyle,this.state_.fillColor&&n.default.equals(i,this.state_.fillColor)||(this.state_.fillColor=i,this.state_.changed=!0,this.styles_.push(i)),e)this.lineStringReplay.setFillStrokeStyle(null,e);else{var r=new v.default({color:[0,0,0,0],lineWidth:0});this.lineStringReplay.setFillStrokeStyle(null,r)}},e.default=T},1375:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(i(1)),a=s(i(1348)),n=s(i(1349));function s(t){return t&&t.__esModule?t:{default:t}}var o={};o.fragment=new a.default(r.default.DEBUG_WEBGL?"precision mediump float;\n\n\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main(void) {\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),o.vertex=new n.default(r.default.DEBUG_WEBGL?"\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n}\n\n\n":"attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}"),e.default=o},1376:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,a=i(1),n=(r=a)&&r.__esModule?r:{default:r};e.default=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_projectionMatrix":"b"),this.u_offsetScaleMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_offsetScaleMatrix":"c"),this.u_offsetRotateMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_offsetRotateMatrix":"d"),this.u_color=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_color":"e"),this.u_opacity=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_opacity":"f"),this.a_position=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_position":"a")}},1377:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){this.first_=void 0,this.last_=void 0,this.head_=void 0,this.circular_=void 0===t||t,this.length_=0};r.prototype.insertItem=function(t){var e={prev:void 0,next:void 0,data:t},i=this.head_;if(i){var r=i.next;e.prev=i,e.next=r,i.next=e,r&&(r.prev=e),i===this.last_&&(this.last_=e)}else this.first_=e,this.last_=e,this.circular_&&(e.next=e,e.prev=e);this.head_=e,this.length_++},r.prototype.removeItem=function(){var t=this.head_;if(t){var e=t.next,i=t.prev;e&&(e.prev=i),i&&(i.next=e),this.head_=e||i,this.first_===this.last_?(this.head_=void 0,this.first_=void 0,this.last_=void 0):this.first_===t?this.first_=this.head_:this.last_===t&&(this.last_=i?this.head_.prev:this.head_),this.length_--}},r.prototype.firstItem=function(){if(this.head_=this.first_,this.head_)return this.head_.data},r.prototype.lastItem=function(){if(this.head_=this.last_,this.head_)return this.head_.data},r.prototype.nextItem=function(){if(this.head_&&this.head_.next)return this.head_=this.head_.next,this.head_.data},r.prototype.getNextItem=function(){if(this.head_&&this.head_.next)return this.head_.next.data},r.prototype.prevItem=function(){if(this.head_&&this.head_.prev)return this.head_=this.head_.prev,this.head_.data},r.prototype.getPrevItem=function(){if(this.head_&&this.head_.prev)return this.head_.prev.data},r.prototype.getCurrItem=function(){if(this.head_)return this.head_.data},r.prototype.setFirstItem=function(){this.circular_&&this.head_&&(this.first_=this.head_,this.last_=this.head_.prev)},r.prototype.concat=function(t){if(t.head_){if(this.head_){var e=this.head_.next;this.head_.next=t.first_,t.first_.prev=this.head_,e.prev=t.last_,t.last_.next=e,this.length_+=t.length_}else this.head_=t.head_,this.first_=t.first_,this.last_=t.last_,this.length_=t.length_;t.head_=void 0,t.first_=void 0,t.last_=void 0,t.length_=0}},r.prototype.getLength=function(){return this.length_},e.default=r},1378:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=c(i(1)),a=c(i(178)),n=c(i(38)),s=c(i(33)),o=c(i(74)),l=c(i(177)),u=c(i(1351)),f=c(i(1358)),d=c(i(1379)),h=c(i(1347));function c(t){return t&&t.__esModule?t:{default:t}}var _=function(t,e){f.default.call(this,t,e),this.images_=[],this.textures_=[],this.measureCanvas_=n.default.createCanvasContext2D(0,0).canvas,this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.atlases_={},this.currAtlas_=void 0,this.scale=1,this.opacity=1};r.default.inherits(_,f.default),_.prototype.drawText=function(t,e){if(this.text_){var i=null,a=2,n=2;switch(t.getType()){case s.default.POINT:case s.default.MULTI_POINT:a=(i=t.getFlatCoordinates()).length,n=t.getStride();break;case s.default.CIRCLE:i=t.getCenter();break;case s.default.LINE_STRING:i=t.getFlatMidpoint();break;case s.default.MULTI_LINE_STRING:a=(i=t.getFlatMidpoints()).length;break;case s.default.POLYGON:i=t.getFlatInteriorPoint();break;case s.default.MULTI_POLYGON:a=(i=t.getFlatInteriorPoints()).length}this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var o,l,u,f,d,h,c,_,p=this.currAtlas_,g=this.text_.split("\n"),v=this.getTextSize_(g),y=Math.round(v[0]*this.textAlign_-this.offsetX_),x=Math.round(v[1]*this.textBaseline_-this.offsetY_),m=this.state_.lineWidth/2*this.state_.scale;for(o=0,l=g.length;o<l;++o)for(d=0,h=p.height*o,u=0,f=(c=g[o].split("")).length;u<f;++u){if(_=p.atlas.getInfo(c[u])){var E,C=_.image;this.anchorX=y-d,this.anchorY=x-h,this.originX=0===u?_.offsetX-m:_.offsetX,this.originY=_.offsetY,this.height=p.height,this.width=0===u||u===c.length-1?p.width[c[u]]+m:p.width[c[u]],this.imageHeight=C.height,this.imageWidth=C.width,0===this.images_.length?this.images_.push(C):(E=this.images_[this.images_.length-1],r.default.getUid(E)!=r.default.getUid(C)&&(this.groupIndices.push(this.indices.length),this.images_.push(C))),this.drawText_(i,0,a,n)}d+=this.width}}},_.prototype.getTextSize_=function(t){var e=this,i=this.currAtlas_,r=t.length*i.height;return[t.map(function(t){var r,a,n=0;for(r=0,a=t.length;r<a;++r){var s=t[r];i.width[s]||e.addCharToAtlas_(s),n+=i.width[s]?i.width[s]:0}return n}).reduce(function(t,e){return Math.max(t,e)}),r]},_.prototype.drawText_=function(t,e,i,r){var a,n;for(a=e,n=i;a<n;a+=r)this.drawCoordinates(t,e,i,r)},_.prototype.addCharToAtlas_=function(t){if(1===t.length){var e=this.currAtlas_,i=this.state_,r=this.measureCanvas_.getContext("2d");r.font=i.font;var a=Math.ceil(r.measureText(t).width*i.scale);e.atlas.add(t,a,e.height,function(e,r,a){e.font=i.font,e.fillStyle=i.fillColor,e.strokeStyle=i.strokeColor,e.lineWidth=i.lineWidth,e.lineCap=i.lineCap,e.lineJoin=i.lineJoin,e.miterLimit=i.miterLimit,e.textAlign="left",e.textBaseline="top",o.default.CANVAS_LINE_DASH&&i.lineDash&&(e.setLineDash(i.lineDash),e.lineDashOffset=i.lineDashOffset),1!==i.scale&&e.setTransform(i.scale,0,0,i.scale,0,0),i.strokeColor&&e.strokeText(t,r,a),i.fillColor&&e.fillText(t,r,a)})&&(e.width[t]=a)}},_.prototype.finish=function(t){var e=t.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices=this.groupIndices,this.verticesBuffer=new h.default(this.vertices),this.indicesBuffer=new h.default(this.indices);this.createTextures(this.textures_,this.images_,{},e),this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.images_=null,this.atlases_={},this.currAtlas_=void 0,f.default.prototype.finish.call(this,t)},_.prototype.setTextStyle=function(t){var e=this.state_,i=t.getFill(),r=t.getStroke();if(t&&t.getText()&&(i||r)){if(i){var n=i.getColor();e.fillColor=a.default.asColorLike(n||u.default.defaultFillStyle)}else e.fillColor=null;if(r){var s=r.getColor();e.strokeColor=a.default.asColorLike(s||u.default.defaultStrokeStyle),e.lineWidth=r.getWidth()||u.default.defaultLineWidth,e.lineCap=r.getLineCap()||u.default.defaultLineCap,e.lineDashOffset=r.getLineDashOffset()||u.default.defaultLineDashOffset,e.lineJoin=r.getLineJoin()||u.default.defaultLineJoin,e.miterLimit=r.getMiterLimit()||u.default.defaultMiterLimit;var o=r.getLineDash();e.lineDash=o?o.slice():u.default.defaultLineDash}else e.strokeColor=null,e.lineWidth=0;e.font=t.getFont()||u.default.defaultFont,e.scale=t.getScale()||1,this.text_=t.getText();var f=l.default.TEXT_ALIGN[t.getTextAlign()],d=l.default.TEXT_ALIGN[t.getTextBaseline()];this.textAlign_=void 0===f?u.default.defaultTextAlign:f,this.textBaseline_=void 0===d?u.default.defaultTextBaseline:d,this.offsetX_=t.getOffsetX()||0,this.offsetY_=t.getOffsetY()||0,this.rotateWithView=!!t.getRotateWithView(),this.rotation=t.getRotation()||0,this.currAtlas_=this.getAtlas_(e)}else this.text_=""},_.prototype.getAtlas_=function(t){var e,i=[];for(e in t)(t[e]||0===t[e])&&(Array.isArray(t[e])?i=i.concat(t[e]):i.push(t[e]));var r=this.calculateHash_(i);if(!this.atlases_[r]){var a=this.measureCanvas_.getContext("2d");a.font=t.font;var n=Math.ceil((1.5*a.measureText("M").width+t.lineWidth/2)*t.scale);this.atlases_[r]={atlas:new d.default({space:t.lineWidth+1}),width:{},height:n}}return this.atlases_[r]},_.prototype.calculateHash_=function(t){var e,i,r="";for(e=0,i=t.length;e<i;++e)r+=t[e];return r},_.prototype.getTextures=function(t){return this.textures_},_.prototype.getHitDetectionTextures=function(){return this.textures_},e.default=_},1379:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(i(1)),a=n(i(1380));function n(t){return t&&t.__esModule?t:{default:t}}var s=function(t){var e=t||{};this.currentSize_=void 0!==e.initialSize?e.initialSize:r.default.INITIAL_ATLAS_SIZE,this.maxSize_=void 0!==e.maxSize?e.maxSize:-1!=r.default.MAX_ATLAS_SIZE?r.default.MAX_ATLAS_SIZE:void 0!==r.default.WEBGL_MAX_TEXTURE_SIZE?r.default.WEBGL_MAX_TEXTURE_SIZE:2048,this.space_=void 0!==e.space?e.space:1,this.atlases_=[new a.default(this.currentSize_,this.space_)],this.currentHitSize_=this.currentSize_,this.hitAtlases_=[new a.default(this.currentHitSize_,this.space_)]};s.prototype.getInfo=function(t){var e=this.getInfo_(this.atlases_,t);if(!e)return null;var i=this.getInfo_(this.hitAtlases_,t);return this.mergeInfos_(e,i)},s.prototype.getInfo_=function(t,e){var i,r,a;for(r=0,a=t.length;r<a;++r)if(i=t[r].get(e))return i;return null},s.prototype.mergeInfos_=function(t,e){return{offsetX:t.offsetX,offsetY:t.offsetY,image:t.image,hitImage:e.image}},s.prototype.add=function(t,e,i,a,n,s){if(e+this.space_>this.maxSize_||i+this.space_>this.maxSize_)return null;var o=this.add_(!1,t,e,i,a,s);if(!o)return null;var l=void 0!==n?n:r.default.nullFunction,u=this.add_(!0,t,e,i,l,s);return this.mergeInfos_(o,u)},s.prototype.add_=function(t,e,i,r,n,s){var o,l,u,f,d=t?this.hitAtlases_:this.atlases_;for(u=0,f=d.length;u<f;++u){if(l=(o=d[u]).add(e,i,r,n,s))return l;var h;l||u!==f-1||(t?(h=Math.min(2*this.currentHitSize_,this.maxSize_),this.currentHitSize_=h):(h=Math.min(2*this.currentSize_,this.maxSize_),this.currentSize_=h),o=new a.default(h,this.space_),d.push(o),++f)}return null},e.default=s},1380:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,a=i(38),n=(r=a)&&r.__esModule?r:{default:r};var s=function(t,e){this.space_=e,this.emptyBlocks_=[{x:0,y:0,width:t,height:t}],this.entries_={},this.context_=n.default.createCanvasContext2D(t,t),this.canvas_=this.context_.canvas};s.prototype.get=function(t){return this.entries_[t]||null},s.prototype.add=function(t,e,i,r,a){var n,s,o;for(s=0,o=this.emptyBlocks_.length;s<o;++s)if((n=this.emptyBlocks_[s]).width>=e+this.space_&&n.height>=i+this.space_){var l={offsetX:n.x+this.space_,offsetY:n.y+this.space_,image:this.canvas_};return this.entries_[t]=l,r.call(a,this.context_,n.x+this.space_,n.y+this.space_),this.split_(s,n,e+this.space_,i+this.space_),l}return null},s.prototype.split_=function(t,e,i,r){var a,n;e.width-i>e.height-r?(a={x:e.x+i,y:e.y,width:e.width-i,height:e.height},n={x:e.x,y:e.y+r,width:i,height:e.height-r},this.updateBlocks_(t,a,n)):(a={x:e.x+i,y:e.y,width:e.width-i,height:r},n={x:e.x,y:e.y+r,width:e.width,height:e.height-r},this.updateBlocks_(t,a,n))},s.prototype.updateBlocks_=function(t,e,i){var r=[t,1];e.width>0&&e.height>0&&r.push(e),i.width>0&&i.height>0&&r.push(i),this.emptyBlocks_.splice.apply(this.emptyBlocks_,r)},e.default=s},1381:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(i(1)),a=s(i(1348)),n=s(i(1349));function s(t){return t&&t.__esModule?t:{default:t}}var o={};o.fragment=new a.default(r.default.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n":"precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}"),o.vertex=new n.default(r.default.DEBUG_WEBGL?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}"),e.default=o},1382:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,a=i(1),n=(r=a)&&r.__esModule?r:{default:r};e.default=function(t,e){this.u_texCoordMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_texCoordMatrix":"d"),this.u_projectionMatrix=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_projectionMatrix":"e"),this.u_opacity=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_opacity":"f"),this.u_texture=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_texture":"g"),this.a_position=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_position":"b"),this.a_texCoord=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_texCoord":"c")}},1383:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=E(i(1)),a=E(i(28)),n=E(i(143)),s=E(i(38)),o=E(i(19)),l=E(i(74)),u=E(i(145)),f=E(i(327)),d=E(i(176)),h=E(i(1354)),c=E(i(560)),_=E(i(120)),p=E(i(99)),g=E(i(329)),v=E(i(331)),y=E(i(553)),x=E(i(1352)),m=E(i(1359));function E(t){return t&&t.__esModule?t:{default:t}}var C=function(t,e){c.default.call(this,t,e),this.canvas_=document.createElement("CANVAS"),this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=n.default.CLASS_UNSELECTABLE,t.insertBefore(this.canvas_,t.childNodes[0]||null),this.clipTileCanvasWidth_=0,this.clipTileCanvasHeight_=0,this.clipTileContext_=s.default.createCanvasContext2D(),this.renderedVisible_=!0,this.gl_=y.default.getContext(this.canvas_,{antialias:!0,depth:!0,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0}),this.context_=new x.default(this.canvas_,this.gl_),o.default.listen(this.canvas_,m.default.LOST,this.handleWebGLContextLost,this),o.default.listen(this.canvas_,m.default.RESTORED,this.handleWebGLContextRestored,this),this.textureCache_=new g.default,this.focus_=null,this.tileTextureQueue_=new v.default(function(t){var e=t[1],i=t[2],r=e[0]-this.focus_[0],a=e[1]-this.focus_[1];return 65536*Math.log(i)+Math.sqrt(r*r+a*a)/i}.bind(this),function(t){return t[0].getKey()}),this.loadNextTileTexture_=function(t,e){if(!this.tileTextureQueue_.isEmpty()){this.tileTextureQueue_.reprioritize();var i=this.tileTextureQueue_.dequeue(),r=i[0],a=i[3],n=i[4];this.bindTileTexture(r,a,n,y.default.LINEAR,y.default.LINEAR)}return!1}.bind(this),this.textureCacheFrameMarkerCount_=0,this.initializeGL_()};r.default.inherits(C,c.default),C.handles=function(t){return l.default.WEBGL&&t===_.default.WEBGL},C.create=function(t,e){return new C(t,e)},C.prototype.bindTileTexture=function(t,e,i,r,a){var n=this.getGL(),s=t.getKey();if(this.textureCache_.containsKey(s)){var o=this.textureCache_.get(s);n.bindTexture(y.default.TEXTURE_2D,o.texture),o.magFilter!=r&&(n.texParameteri(y.default.TEXTURE_2D,y.default.TEXTURE_MAG_FILTER,r),o.magFilter=r),o.minFilter!=a&&(n.texParameteri(y.default.TEXTURE_2D,y.default.TEXTURE_MIN_FILTER,a),o.minFilter=a)}else{var l=n.createTexture();if(n.bindTexture(y.default.TEXTURE_2D,l),i>0){var u=this.clipTileContext_.canvas,f=this.clipTileContext_;this.clipTileCanvasWidth_!==e[0]||this.clipTileCanvasHeight_!==e[1]?(u.width=e[0],u.height=e[1],this.clipTileCanvasWidth_=e[0],this.clipTileCanvasHeight_=e[1]):f.clearRect(0,0,e[0],e[1]),f.drawImage(t.getImage(),i,i,e[0],e[1],0,0,e[0],e[1]),n.texImage2D(y.default.TEXTURE_2D,0,y.default.RGBA,y.default.RGBA,y.default.UNSIGNED_BYTE,u)}else n.texImage2D(y.default.TEXTURE_2D,0,y.default.RGBA,y.default.RGBA,y.default.UNSIGNED_BYTE,t.getImage());n.texParameteri(y.default.TEXTURE_2D,y.default.TEXTURE_MAG_FILTER,r),n.texParameteri(y.default.TEXTURE_2D,y.default.TEXTURE_MIN_FILTER,a),n.texParameteri(y.default.TEXTURE_2D,y.default.TEXTURE_WRAP_S,y.default.CLAMP_TO_EDGE),n.texParameteri(y.default.TEXTURE_2D,y.default.TEXTURE_WRAP_T,y.default.CLAMP_TO_EDGE),this.textureCache_.set(s,{texture:l,magFilter:r,minFilter:a})}},C.prototype.dispatchComposeEvent_=function(t,e){var i=this.getMap();if(i.hasListener(t)){var r=this.context_,a=e.extent,n=e.size,s=e.viewState,o=e.pixelRatio,l=s.resolution,u=s.center,d=s.rotation,c=new h.default(r,u,l,d,n,a,o),_=new f.default(t,c,e,null,r);i.dispatchEvent(_)}},C.prototype.disposeInternal=function(){var t=this.getGL();t.isContextLost()||this.textureCache_.forEach(function(e){e&&t.deleteTexture(e.texture)}),this.context_.dispose(),c.default.prototype.disposeInternal.call(this)},C.prototype.expireCache_=function(t,e){for(var i,a=this.getGL();this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>r.default.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK;){if(i=this.textureCache_.peekLast())a.deleteTexture(i.texture);else{if(+this.textureCache_.peekLastKey()==e.index)break;--this.textureCacheFrameMarkerCount_}this.textureCache_.pop()}},C.prototype.getContext=function(){return this.context_},C.prototype.getGL=function(){return this.gl_},C.prototype.getTileTextureQueue=function(){return this.tileTextureQueue_},C.prototype.getType=function(){return _.default.WEBGL},C.prototype.handleWebGLContextLost=function(t){t.preventDefault(),this.textureCache_.clear(),this.textureCacheFrameMarkerCount_=0;var e=this.getLayerRenderers();for(var i in e){e[i].handleWebGLContextLost()}},C.prototype.handleWebGLContextRestored=function(){this.initializeGL_(),this.getMap().render()},C.prototype.initializeGL_=function(){var t=this.gl_;t.activeTexture(y.default.TEXTURE0),t.blendFuncSeparate(y.default.SRC_ALPHA,y.default.ONE_MINUS_SRC_ALPHA,y.default.ONE,y.default.ONE_MINUS_SRC_ALPHA),t.disable(y.default.CULL_FACE),t.disable(y.default.DEPTH_TEST),t.disable(y.default.SCISSOR_TEST),t.disable(y.default.STENCIL_TEST)},C.prototype.isTileTextureLoaded=function(t){return this.textureCache_.containsKey(t.getKey())},C.prototype.renderFrame=function(t){var e=this.getContext(),i=this.getGL();if(i.isContextLost())return!1;if(!t)return this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1),!1;this.focus_=t.focus,this.textureCache_.set((-t.index).toString(),null),++this.textureCacheFrameMarkerCount_,this.dispatchComposeEvent_(d.default.PRECOMPOSE,t);var n=[],s=t.layerStatesArray;a.default.stableSort(s,c.default.sortByZIndex);var o,l,f,h=t.viewState.resolution;for(o=0,l=s.length;o<l;++o)f=s[o],u.default.visibleAtResolution(f,h)&&f.sourceState==p.default.READY&&this.getLayerRenderer(f.layer).prepareFrame(t,f,e)&&n.push(f);var _=t.size[0]*t.pixelRatio,g=t.size[1]*t.pixelRatio;for(this.canvas_.width==_&&this.canvas_.height==g||(this.canvas_.width=_,this.canvas_.height=g),i.bindFramebuffer(y.default.FRAMEBUFFER,null),i.clearColor(0,0,0,0),i.clear(y.default.COLOR_BUFFER_BIT),i.enable(y.default.BLEND),i.viewport(0,0,this.canvas_.width,this.canvas_.height),o=0,l=n.length;o<l;++o)f=n[o],this.getLayerRenderer(f.layer).composeFrame(t,f,e);this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.calculateMatrices2D(t),this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>r.default.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK&&t.postRenderFunctions.push(this.expireCache_.bind(this)),this.tileTextureQueue_.isEmpty()||(t.postRenderFunctions.push(this.loadNextTileTexture_),t.animate=!0),this.dispatchComposeEvent_(d.default.POSTCOMPOSE,t),this.scheduleRemoveUnusedLayerRenderers(t),this.scheduleExpireIconCache(t)},C.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,a,n,s){var o;if(this.getGL().isContextLost())return!1;var l,f=e.viewState,d=e.layerStatesArray;for(l=d.length-1;l>=0;--l){var h=d[l],c=h.layer;if(u.default.visibleAtResolution(h,f.resolution)&&n.call(s,c))if(o=this.getLayerRenderer(c).forEachFeatureAtCoordinate(t,e,i,r,a))return o}},C.prototype.hasFeatureAtCoordinate=function(t,e,i,r,a){var n=!1;if(this.getGL().isContextLost())return!1;var s,o=e.viewState,l=e.layerStatesArray;for(s=l.length-1;s>=0;--s){var f=l[s],d=f.layer;if(u.default.visibleAtResolution(f,o.resolution)&&r.call(a,d))if(n=this.getLayerRenderer(d).hasFeatureAtCoordinate(t,e))return!0}return n},C.prototype.forEachLayerAtPixel=function(t,e,i,r,a,n){if(this.getGL().isContextLost())return!1;var s,o,l=e.viewState,f=e.layerStatesArray;for(o=f.length-1;o>=0;--o){var d=f[o],h=d.layer;if(u.default.visibleAtResolution(d,l.resolution)&&a.call(r,h))if(s=this.getLayerRenderer(h).forEachLayerAtPixel(t,e,i,r))return s}},e.default=C},1384:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=x(i(13)),a=x(i(1)),n=x(i(98)),s=x(i(232)),o=x(i(52)),l=x(i(28)),u=x(i(11)),f=x(i(20)),d=x(i(120)),h=x(i(1353)),c=x(i(1385)),_=x(i(1386)),p=x(i(144)),g=x(i(47)),v=x(i(553)),y=x(i(1347));function x(t){return t&&t.__esModule?t:{default:t}}var m=function(t,e){h.default.call(this,t,e),this.fragmentShader_=c.default.fragment,this.vertexShader_=c.default.vertex,this.locations_=null,this.renderArrayBuffer_=new y.default([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]),this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,this.tmpSize_=[0,0]};a.default.inherits(m,h.default),m.handles=function(t,e){return t===d.default.WEBGL&&e.getType()===n.default.TILE},m.create=function(t,e){return new m(t,e)},m.prototype.disposeInternal=function(){this.mapRenderer.getContext().deleteBuffer(this.renderArrayBuffer_),h.default.prototype.disposeInternal.call(this)},m.prototype.createLoadedTileFinder=function(t,e,i){var r=this.mapRenderer;return function(a,n){return t.forEachLoadedTile(e,a,n,function(t){var e=r.isTileTextureLoaded(t);return e&&(i[a]||(i[a]={}),i[a][t.tileCoord.toString()]=t),e})}},m.prototype.handleWebGLContextLost=function(){h.default.prototype.handleWebGLContextLost.call(this),this.locations_=null},m.prototype.prepareFrame=function(t,e,i){var a,n=this.mapRenderer,d=i.getGL(),h=t.viewState,c=h.projection,y=this.getLayer(),x=y.getSource(),m=x.getTileGridForProjection(c),E=m.getZForResolution(h.resolution),C=m.getResolution(E),T=x.getTilePixelSize(E,t.pixelRatio,c),I=T[0]/p.default.toSize(m.getTileSize(E),this.tmpSize_)[0],L=C/I,R=x.getTilePixelRatio(I)*x.getGutter(c),S=h.center,b=t.extent,M=m.getTileRangeForExtentAndZ(b,E);if(this.renderedTileRange_&&this.renderedTileRange_.equals(M)&&this.renderedRevision_==x.getRevision())a=this.renderedFramebufferExtent_;else{var F=M.getSize(),D=Math.max(F[0]*T[0],F[1]*T[1]),A=f.default.roundUpToPowerOfTwo(D),P=L*A,B=m.getOrigin(E),w=B[0]+M.minX*T[0]*L,G=B[1]+M.minY*T[1]*L;a=[w,G,w+P,G+P],this.bindFramebuffer(t,A),d.viewport(0,0,A,A),d.clearColor(0,0,0,0),d.clear(v.default.COLOR_BUFFER_BIT),d.disable(v.default.BLEND);var U=i.getProgram(this.fragmentShader_,this.vertexShader_);i.useProgram(U),this.locations_||(this.locations_=new _.default(d,U)),i.bindBuffer(v.default.ARRAY_BUFFER,this.renderArrayBuffer_),d.enableVertexAttribArray(this.locations_.a_position),d.vertexAttribPointer(this.locations_.a_position,2,v.default.FLOAT,!1,16,0),d.enableVertexAttribArray(this.locations_.a_texCoord),d.vertexAttribPointer(this.locations_.a_texCoord,2,v.default.FLOAT,!1,16,8),d.uniform1i(this.locations_.u_texture,0);var O={};O[E]={};var W,N,k,V,j,z,H=this.createLoadedTileFinder(x,c,O),X=y.getUseInterimTilesOnError(),Y=!0,q=u.default.createEmpty(),Z=new s.default(0,0,0,0);for(V=M.minX;V<=M.maxX;++V)for(j=M.minY;j<=M.maxY;++j)if(N=x.getTile(E,V,j,I,c),void 0===e.extent||(z=m.getTileCoordExtent(N.tileCoord,q),u.default.intersects(z,e.extent))){if((k=N.getState())==o.default.LOADED||k==o.default.EMPTY||k==o.default.ERROR&&!X||(N=N.getInterimTile()),(k=N.getState())==o.default.LOADED){if(n.isTileTextureLoaded(N)){O[E][N.tileCoord.toString()]=N;continue}}else if(k==o.default.EMPTY||k==o.default.ERROR&&!X)continue;Y=!1,m.forEachTileCoordParentTileRange(N.tileCoord,H,null,Z,q)||(W=m.getTileCoordChildTileRange(N.tileCoord,Z,q))&&H(E+1,W)}var J=(0,r.default)(O).map(Number);J.sort(l.default.numberSafeCompareFunction);var K,Q,$,tt,et=new Float32Array(4);for(K=0,Q=J.length;K<Q;++K)for($ in tt=O[J[K]])N=tt[$],z=m.getTileCoordExtent(N.tileCoord,q),et[0]=2*(z[2]-z[0])/P,et[1]=2*(z[3]-z[1])/P,et[2]=2*(z[0]-a[0])/P-1,et[3]=2*(z[1]-a[1])/P-1,d.uniform4fv(this.locations_.u_tileOffset,et),n.bindTileTexture(N,T,R*I,v.default.LINEAR,v.default.LINEAR),d.drawArrays(v.default.TRIANGLE_STRIP,0,4);Y?(this.renderedTileRange_=M,this.renderedFramebufferExtent_=a,this.renderedRevision_=x.getRevision()):(this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,t.animate=!0)}this.updateUsedTiles(t.usedTiles,x,E,M);var it=n.getTileTextureQueue();this.manageTilePyramid(t,x,m,I,c,b,E,y.getPreload(),function(t){t.getState()!=o.default.LOADED||n.isTileTextureLoaded(t)||it.isKeyQueued(t.getKey())||it.enqueue([t,m.getTileCoordCenter(t.tileCoord),m.getResolution(t.tileCoord[0]),T,R*I])},this),this.scheduleExpireCache(t,x),this.updateLogos(t,x);var rt=this.texCoordMatrix;return g.default.reset(rt),g.default.translate(rt,(Math.round(S[0]/C)*C-a[0])/(a[2]-a[0]),(Math.round(S[1]/C)*C-a[1])/(a[3]-a[1])),0!==h.rotation&&g.default.rotate(rt,h.rotation),g.default.scale(rt,t.size[0]*h.resolution/(a[2]-a[0]),t.size[1]*h.resolution/(a[3]-a[1])),g.default.translate(rt,-.5,-.5),!0},m.prototype.forEachLayerAtPixel=function(t,e,i,r){if(this.framebuffer){var a=[t[0]/e.size[0],(e.size[1]-t[1])/e.size[1]],n=g.default.apply(this.texCoordMatrix,a.slice()),s=[n[0]*this.framebufferDimension,n[1]*this.framebufferDimension],o=this.mapRenderer.getContext().getGL();o.bindFramebuffer(o.FRAMEBUFFER,this.framebuffer);var l=new Uint8Array(4);return o.readPixels(s[0],s[1],1,1,o.RGBA,o.UNSIGNED_BYTE,l),l[3]>0?i.call(r,this.getLayer(),l):void 0}},e.default=m},1385:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(i(1)),a=s(i(1348)),n=s(i(1349));function s(t){return t&&t.__esModule?t:{default:t}}var o={};o.fragment=new a.default(r.default.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n":"precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}"),o.vertex=new n.default(r.default.DEBUG_WEBGL?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}"),e.default=o},1386:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,a=i(1),n=(r=a)&&r.__esModule?r:{default:r};e.default=function(t,e){this.u_tileOffset=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_tileOffset":"d"),this.u_texture=t.getUniformLocation(e,n.default.DEBUG_WEBGL?"u_texture":"e"),this.a_position=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_position":"b"),this.a_texCoord=t.getAttribLocation(e,n.default.DEBUG_WEBGL?"a_texCoord":"c")}},1387:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=h(i(1)),a=h(i(98)),n=h(i(66)),s=h(i(11)),o=h(i(1355)),l=h(i(120)),u=h(i(334)),f=h(i(1353)),d=h(i(47));function h(t){return t&&t.__esModule?t:{default:t}}var c=function(t,e){f.default.call(this,t,e),this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=s.default.createEmpty(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.layerState_=null};r.default.inherits(c,f.default),c.handles=function(t,e){return t===l.default.WEBGL&&e.getType()===a.default.VECTOR},c.create=function(t,e){return new c(t,e)},c.prototype.composeFrame=function(t,e,i){this.layerState_=e;var r=t.viewState,a=this.replayGroup_,n=t.size,s=t.pixelRatio,o=this.mapRenderer.getGL();a&&!a.isEmpty()&&(o.enable(o.SCISSOR_TEST),o.scissor(0,0,n[0]*s,n[1]*s),a.replay(i,r.center,r.resolution,r.rotation,n,s,e.opacity,e.managed?t.skippedFeatureUids:{}),o.disable(o.SCISSOR_TEST))},c.prototype.disposeInternal=function(){var t=this.replayGroup_;if(t){var e=this.mapRenderer.getContext();t.getDeleteResourcesFunction(e)(),this.replayGroup_=null}f.default.prototype.disposeInternal.call(this)},c.prototype.forEachFeatureAtCoordinate=function(t,e,i,a,n){if(this.replayGroup_&&this.layerState_){var s=this.mapRenderer.getContext(),o=e.viewState,l=this.getLayer(),u=this.layerState_,f={};return this.replayGroup_.forEachFeatureAtCoordinate(t,s,o.center,o.resolution,o.rotation,e.size,e.pixelRatio,u.opacity,{},function(t){var e=r.default.getUid(t).toString();if(!(e in f))return f[e]=!0,a.call(n,t,l)})}},c.prototype.hasFeatureAtCoordinate=function(t,e){if(this.replayGroup_&&this.layerState_){var i=this.mapRenderer.getContext(),r=e.viewState,a=this.layerState_;return this.replayGroup_.hasFeatureAtCoordinate(t,i,r.center,r.resolution,r.rotation,e.size,e.pixelRatio,a.opacity,e.skippedFeatureUids)}return!1},c.prototype.forEachLayerAtPixel=function(t,e,i,r){var a=d.default.apply(e.pixelToCoordinateTransform,t.slice());return this.hasFeatureAtCoordinate(a,e)?i.call(r,this.getLayer(),null):void 0},c.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},c.prototype.prepareFrame=function(t,e,i){var r=this.getLayer(),a=r.getSource();this.updateLogos(t,a);var l=t.viewHints[n.default.ANIMATING],f=t.viewHints[n.default.INTERACTING],d=r.getUpdateWhileAnimating(),h=r.getUpdateWhileInteracting();if(!this.dirty_&&!d&&l||!h&&f)return!0;var c=t.extent,_=t.viewState,p=_.projection,g=_.resolution,v=t.pixelRatio,y=r.getRevision(),x=r.getRenderBuffer(),m=r.getRenderOrder();void 0===m&&(m=u.default.defaultOrder);var E=s.default.buffer(c,x*g);if(!this.dirty_&&this.renderedResolution_==g&&this.renderedRevision_==y&&this.renderedRenderOrder_==m&&s.default.containsExtent(this.renderedExtent_,E))return!0;this.replayGroup_&&t.postRenderFunctions.push(this.replayGroup_.getDeleteResourcesFunction(i)),this.dirty_=!1;var C=new o.default(u.default.getTolerance(g,v),E,r.getRenderBuffer());a.loadFeatures(E,g,p);var T=function(t){var e,i=t.getStyleFunction();if(i?e=i.call(t,g):(i=r.getStyleFunction())&&(e=i(t,g)),e){var a=this.renderFeature(t,g,v,e,C);this.dirty_=this.dirty_||a}};if(m){var I=[];a.forEachFeatureInExtent(E,function(t){I.push(t)},this),I.sort(m),I.forEach(T,this)}else a.forEachFeatureInExtent(E,T,this);return C.finish(i),this.renderedResolution_=g,this.renderedRevision_=y,this.renderedRenderOrder_=m,this.renderedExtent_=E,this.replayGroup_=C,!0},c.prototype.renderFeature=function(t,e,i,r,a){if(!r)return!1;var n=!1;if(Array.isArray(r))for(var s=r.length-1;s>=0;--s)n=u.default.renderFeature(a,t,r[s],u.default.getSquaredTolerance(e,i),this.handleStyleImageChange_,this)||n;else n=u.default.renderFeature(a,t,r,u.default.getSquaredTolerance(e,i),this.handleStyleImageChange_,this)||n;return n},e.default=c},565:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=x(i(1)),a=x(i(554)),n=x(i(332)),s=x(i(555)),o=x(i(556)),l=x(i(18)),u=x(i(180)),f=x(i(557)),d=x(i(559)),h=x(i(333)),c=x(i(561)),_=x(i(563)),p=x(i(1361)),g=x(i(1383)),v=x(i(1384)),y=x(i(1387));function x(t){return t&&t.__esModule?t:{default:t}}r.default.ENABLE_CANVAS&&(u.default.register(n.default.MAP_RENDERER,d.default),u.default.registerMultiple(n.default.LAYER_RENDERER,[f.default,h.default,c.default,_.default])),r.default.ENABLE_WEBGL&&(u.default.register(n.default.MAP_RENDERER,g.default),u.default.registerMultiple(n.default.LAYER_RENDERER,[p.default,v.default,y.default]));var m=function(t){(t=l.default.assign({},t)).controls||(t.controls=s.default.defaults()),t.interactions||(t.interactions=o.default.defaults()),a.default.call(this,t)};r.default.inherits(m,a.default),e.default=m}});